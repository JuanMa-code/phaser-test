import{r as f,j as u}from"./index-vJFL1dzY.js";import{A as ae,C as K,G as H,T}from"./HTMLText-CeZkFdUK.js";import{G as re,a as oe}from"./GameOverScreen-DshzEBP7.js";const h=10,y=20,i=30,N=h*i,U=y*i,ie=[65535,255,16753920,16776960,65280,16711680,8388736],Z=[[[1,1,1,1]],[[1,0,0],[1,1,1]],[[0,0,1],[1,1,1]],[[1,1],[1,1]],[[0,1,1],[1,1,0]],[[0,1,0],[1,1,1]],[[1,1,0],[0,1,1]]];function W(){const l=Math.floor(Math.random()*Z.length);return{shape:Z[l],color:ie[l],x:Math.floor(h/2)-1,y:0}}const de=()=>{const l=f.useRef(null),[J,w]=f.useState(0),[Q,E]=f.useState(0),[k,j]=f.useState(1),[G,z]=f.useState(!1),[M,V]=f.useState(!1);f.useEffect(()=>{if(!M||G)return;const s=new ae({width:N+200,height:U,backgroundColor:1710638});l.current&&s.view instanceof Node&&l.current.appendChild(s.view);let c=Array.from({length:y},()=>Array(h).fill(null)),n=W(),p=W(),C=!0,O=0,q=Math.max(5,30-k*2),v=0,S=0,m=1;const x=new K,o=new K;o.x=N+20,s.stage.addChild(x),s.stage.addChild(o);const d=new H;d.lineStyle(1,4473924,.3);for(let e=0;e<=h;e++)d.moveTo(e*i,0),d.lineTo(e*i,U);for(let e=0;e<=y;e++)d.moveTo(0,e*i),d.lineTo(N,e*i);x.addChild(d);const b=new T("Score: 0",{fontSize:20,fill:16777215}),A=new T("Lines: 0",{fontSize:20,fill:16777215}),R=new T("Level: 1",{fontSize:20,fill:16777215}),D=new T("Next:",{fontSize:16,fill:16777215});b.y=20,A.y=50,R.y=80,D.y=120,o.addChild(b),o.addChild(A),o.addChild(R),o.addChild(D);function B(e,t,r){const a=new H;return a.beginFill(e),a.drawRoundedRect(0,0,i-2,i-2,3),a.endFill(),a.lineStyle(1,16777215,.3),a.drawRoundedRect(0,0,i-2,i-2,3),a.x=t*i,a.y=r*i,a}function F(){x.removeChildren(),x.addChild(d);for(let e=0;e<y;e++)for(let t=0;t<h;t++)c[e][t]!==null&&x.addChild(B(c[e][t],t,e));for(let e=0;e<n.shape.length;e++)for(let t=0;t<n.shape[e].length;t++)n.shape[e][t]&&x.addChild(B(n.color,n.x+t,n.y+e));o.removeChildren(),o.addChild(b),o.addChild(A),o.addChild(R),o.addChild(D);for(let e=0;e<p.shape.length;e++)for(let t=0;t<p.shape[e].length;t++)if(p.shape[e][t]){const r=new H;r.beginFill(p.color),r.drawRoundedRect(0,0,20,20,2),r.endFill(),r.x=t*22,r.y=150+e*22,o.addChild(r)}}function g(e=0,t=0,r=n.shape){for(let a=0;a<r.length;a++)for(let L=0;L<r[a].length;L++)if(r[a][L]){const I=n.x+L+e,P=n.y+a+t;if(I<0||I>=h||P>=y||P>=0&&c[P][I]!==null)return!0}return!1}function ee(){for(let e=0;e<n.shape.length;e++)for(let t=0;t<n.shape[e].length;t++)if(n.shape[e][t]){const r=n.x+t,a=n.y+e;a>=0&&(c[a][r]=n.color)}}function te(e){return e[0].map((t,r)=>e.map(a=>a[r])).reverse()}function ne(){let e=0;for(let t=y-1;t>=0;t--)c[t].every(r=>r!==null)&&(c.splice(t,1),c.unshift(Array(h).fill(null)),e++,t++);return e>0&&(S+=e,v+=e*100*m,S>=m*10&&(m++,q=Math.max(5,30-m*2)),E(S),w(v),j(m)),e}function _(){if(C){if(O++,O>q){if(O=0,!g(0,1))n.y++;else if(ee(),ne(),n=p,p=W(),g(0,0)){C=!1,z(!0);return}}b.text=`Score: ${v}`,A.text=`Lines: ${S}`,R.text=`Level: ${m}`,F(),requestAnimationFrame(_)}}function $(e){if(C){switch(e.key){case"ArrowLeft":case"a":case"A":g(-1,0)||n.x--;break;case"ArrowRight":case"d":case"D":g(1,0)||n.x++;break;case"ArrowDown":case"s":case"S":g(0,1)||(n.y++,v+=1,w(v));break;case"ArrowUp":case"w":case"W":case" ":const t=te(n.shape);g(0,0,t)||(n.shape=t);break}F()}}return window.addEventListener("keydown",$),F(),_(),()=>{C=!1,window.removeEventListener("keydown",$),l.current&&s.view instanceof Node&&l.current.removeChild(s.view),s.destroy()}},[M,G,k]);const X=()=>{V(!0),z(!1),w(0),E(0),j(1)},Y=()=>{z(!1),w(0),E(0),j(1)};return M?G?u.jsx(oe,{score:J,onRestart:Y,onMenu:()=>window.history.back(),theme:{primary:"#ff6b6b",secondary:"#4ecdc4",accent:"#45b7d1",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},customStats:[{label:"LÃ­neas Completadas",value:Q},{label:"Nivel Alcanzado",value:k}]}):u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)",minHeight:"100dvh",fontFamily:"Arial, sans-serif",color:"white"},children:[u.jsx("h1",{style:{margin:"0 0 20px 0",fontSize:"2.5rem"},children:"ğŸ§© TETRIS"}),u.jsx("div",{ref:l,style:{border:"2px solid #444",borderRadius:"10px"}}),u.jsx("div",{style:{marginTop:"20px",fontSize:"1.2rem"},children:u.jsx("p",{children:"Use â† â†’ A D para mover, â†“ S para bajar rÃ¡pido, â†‘ W Espacio para rotar"})})]}):u.jsx(re,{title:"ğŸ§© TETRIS",description:"Â¡El clÃ¡sico juego de bloques que caen!",instructions:[{title:"Controles",items:["â† â†’ A D: Mover pieza","â†“ S: CaÃ­da rÃ¡pida","â†‘ W Espacio: Rotar"],icon:"ğŸ®"},{title:"PuntuaciÃ³n",items:["LÃ­neas completas: +100 Ã— Nivel","CaÃ­da rÃ¡pida: +1 punto","Cada 10 lÃ­neas: +1 nivel"],icon:"ğŸ“Š"},{title:"Objetivo",items:["Completa lÃ­neas horizontales","Evita que lleguen arriba","Â¡Alcanza el nivel mÃ¡s alto!"],icon:"ğŸ¯"}],onStart:X,theme:{primary:"#ff6b6b",secondary:"#4ecdc4",accent:"#45b7d1",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}})};export{de as default};
