import{r as l,j as r}from"./index-DT6De0vj.js";import{P as i}from"./phaser-CtSIbetW.js";import{G as x,a as b}from"./GameOverScreen-DSWsITTW.js";const p=800,c=600,g=300,w=5,D=10;class B extends i.Scene{player;invaders;playerBullets;invaderBullets;cursors;wasd;lastFired=0;invaderDirection=1;invaderSpeed=50;invaderDropDistance=20;score=0;lives=3;wave=1;isGameOver=!1;onScoreUpdate;onLivesUpdate;onWaveUpdate;onGameOver;constructor(e,t,s,a){super("SpaceInvadersScene"),this.onScoreUpdate=e,this.onLivesUpdate=t,this.onWaveUpdate=s,this.onGameOver=a}preload(){this.createTextures()}createTextures(){const e=this.make.graphics({x:0,y:0});e.fillStyle(65416),e.beginPath(),e.moveTo(20,0),e.lineTo(0,40),e.lineTo(40,40),e.closePath(),e.fillPath(),e.lineStyle(2,65450),e.strokeCircle(20,20,10),e.generateTexture("player",40,40);const t=this.make.graphics({x:0,y:0});t.fillStyle(16777215),t.fillRoundedRect(0,0,30,30,5),t.fillStyle(0),t.fillCircle(8,8,3),t.fillCircle(22,8,3),t.generateTexture("invader",30,30);const s=this.make.graphics({x:0,y:0});s.fillStyle(65535),s.fillRoundedRect(0,0,6,12,2),s.generateTexture("bullet",6,12);const a=this.make.graphics({x:0,y:0});a.fillStyle(16711680),a.fillCircle(3,3,3),a.generateTexture("enemyBullet",6,6)}create(){for(let s=0;s<100;s++){const a=i.Math.Between(0,p),n=i.Math.Between(0,c),d=i.Math.FloatBetween(.2,1);this.add.circle(a,n,i.Math.FloatBetween(.5,2),16777215,d)}this.player=this.add.container(p/2,c-60);const e=this.add.sprite(0,0,"player");this.player.add(e),this.physics.add.existing(this.player);const t=this.player.body;t.setCollideWorldBounds(!0),t.setSize(40,40),t.setOffset(-20,-20),this.invaders=this.physics.add.group(),this.playerBullets=this.physics.add.group(),this.invaderBullets=this.physics.add.group(),this.cursors=this.input.keyboard.createCursorKeys(),this.wasd={left:this.input.keyboard.addKey(i.Input.Keyboard.KeyCodes.A),right:this.input.keyboard.addKey(i.Input.Keyboard.KeyCodes.D),space:this.input.keyboard.addKey(i.Input.Keyboard.KeyCodes.SPACE),w:this.input.keyboard.addKey(i.Input.Keyboard.KeyCodes.W)},this.startWave()}startWave(){this.invaders.clear(!0,!0),this.invaderBullets.clear(!0,!0),this.playerBullets.clear(!0,!0),this.invaderSpeed=50+(this.wave-1)*20,this.invaderDirection=1;const e=[16729156,16755268,4521796,4474111,16729343];for(let t=0;t<w;t++)for(let s=0;s<D;s++){const a=80+s*60,n=80+t*50;this.invaders.create(a,n,"invader").setTint(e[t%e.length])}}update(e,t){this.isGameOver||(this.handlePlayerInput(e),this.updateInvaders(),this.checkCollisions(),this.cleanupBullets())}handlePlayerInput(e){const t=this.player.body;this.cursors.left.isDown||this.wasd.left.isDown?t.setVelocityX(-g):this.cursors.right.isDown||this.wasd.right.isDown?t.setVelocityX(g):t.setVelocityX(0),(this.cursors.up.isDown||this.wasd.space.isDown||this.wasd.w.isDown)&&e>this.lastFired&&(this.fireBullet(),this.lastFired=e+400)}fireBullet(){if(this.playerBullets.countActive()>=3)return;this.playerBullets.create(this.player.x,this.player.y-30,"bullet").setVelocityY(-400)}updateInvaders(){const e=this.invaders.getChildren();if(e.length===0){this.wave++,this.onWaveUpdate(this.wave),this.wave>10?this.gameOver(!0):this.startWave();return}let t=!1;e.forEach(s=>{s.body.velocity.x=this.invaderSpeed*this.invaderDirection,(this.invaderDirection===1&&s.x>=p-30||this.invaderDirection===-1&&s.x<=30)&&(t=!0),i.Math.Between(0,2e3)<5+this.wave&&this.invaderBullets.create(s.x,s.y+20,"enemyBullet").setVelocityY(200+this.wave*20),s.y>c-100&&this.gameOver(!1)}),t&&(this.invaderDirection*=-1,e.forEach(s=>{s.y+=this.invaderDropDistance,s.x+=this.invaderDirection*10}),this.invaderSpeed+=5)}checkCollisions(){this.physics.overlap(this.playerBullets,this.invaders,(e,t)=>{e.destroy(),t.destroy(),this.score+=10,this.onScoreUpdate(this.score)}),this.physics.overlap(this.invaderBullets,this.player,(e,t)=>{t.destroy(),this.lives--,this.onLivesUpdate(this.lives),this.tweens.add({targets:this.player,alpha:0,duration:100,yoyo:!0,repeat:3}),this.lives<=0&&this.gameOver(!1)})}cleanupBullets(){this.playerBullets.children.each(e=>{const t=e;return t.y<-50&&t.destroy(),!0}),this.invaderBullets.children.each(e=>{const t=e;return t.y>c+50&&t.destroy(),!0})}gameOver(e){this.isGameOver=!0,this.physics.pause(),this.onGameOver(e)}}const I=()=>{const[o,e]=l.useState("start"),[t,s]=l.useState(0),[a,n]=l.useState(3),[d,u]=l.useState(1),[y,v]=l.useState(!1),h=l.useRef(null);l.useEffect(()=>{if(o==="playing"){const m={type:i.AUTO,width:p,height:c,parent:"phaser-game",backgroundColor:"#0a0a1a",physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}},scene:new B(s,n,u,S=>{v(S),e("gameover")})};return h.current=new i.Game(m),()=>{h.current&&(h.current.destroy(!0),h.current=null)}}},[o]);const f=()=>{s(0),n(3),u(1),v(!1),e("playing")};return o==="start"?r.jsx(x,{title:"üëæ SPACE INVADERS",description:"¬°Defiende la Tierra de la invasi√≥n alien√≠gena!",instructions:[{title:"Controles",items:["üéÆ ‚Üê ‚Üí A D: Mover nave espacial","üí• Espacio ‚Üë W: Disparar l√°ser","‚ö° M√°ximo 3 balas simult√°neas"],icon:"üéÆ"},{title:"Sistema de Puntuaci√≥n",items:["üëæ Destruye alien√≠genas para ganar puntos","üåä M√°s oleadas = m√°s velocidad","üèÜ ¬°Sobrevive 10 oleadas para ganar!"],icon:"üìä"}],onStart:f,theme:{background:"linear-gradient(135deg, #0a0a1a 0%, #1a1a3a 100%)",accent:"linear-gradient(45deg, #ff0080, #00ff80, #0080ff)",primary:"linear-gradient(45deg, #ff0080, #00ff80)"}}):o==="gameover"?r.jsx(b,{score:t,onRestart:f,onMenu:()=>e("start"),isVictory:y,customStats:[{label:"Oleadas Completadas",value:d-1},{label:"Vidas Restantes",value:a}],theme:{background:y?"linear-gradient(135deg, #0a1a0a 0%, #1a3a1a 100%)":"linear-gradient(135deg, #1a0a0a 0%, #3a1a1a 100%)",primary:"linear-gradient(45deg, #ff0080, #00ff80)",secondary:"linear-gradient(45deg, #0a0a1a, #1a1a3a)"}}):r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",background:"linear-gradient(135deg, #0a0a1a 0%, #1a1a3a 100%)",minHeight:"100dvh",fontFamily:"Arial, sans-serif",color:"white"},children:[r.jsx("h1",{style:{margin:"0 0 20px 0",fontSize:"2.5rem"},children:"üëæ SPACE INVADERS"}),r.jsxs("div",{style:{display:"flex",gap:"2rem",marginBottom:"1rem",fontSize:"1.2rem",fontWeight:"bold"},children:[r.jsxs("span",{children:["Score: ",t]}),r.jsxs("span",{style:{color:"#ff0000"},children:["Lives: ",a]}),r.jsxs("span",{style:{color:"#00ff00"},children:["Wave: ",d]})]}),r.jsx("div",{id:"phaser-game",style:{border:"2px solid #444",borderRadius:"10px",overflow:"hidden"}}),r.jsx("div",{style:{marginTop:"20px",fontSize:"1.2rem"},children:r.jsx("p",{children:"‚Üê ‚Üí A D para mover, Espacio ‚Üë W para disparar"})})]})};export{I as default};
