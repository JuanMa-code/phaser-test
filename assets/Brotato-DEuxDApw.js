import{r as A,j as B}from"./index-vJFL1dzY.js";import{A as ge,C as le,G as x,T as h}from"./HTMLText-CeZkFdUK.js";import{G as we,a as Ce}from"./GameOverScreen-DshzEBP7.js";const p=1e3,k=700,u=120,V=4,he=8,te=.5,ue=120,ve=60,Se=20,be=15,re=3,Te=1800,Me=600,Re=()=>{const Z=A.useRef(null),[fe,ie]=A.useState(0),[F,ne]=A.useState(!1),[ee,ae]=A.useState(!0),r=A.useRef({player:{x:p/2,y:(k+u)/2,radius:15,level:1,exp:0,expToNext:100,damage:1,health:100,maxHealth:100,shield:0,multiShot:1,critChance:.1,critDamage:2},enemies:[],bullets:[],powerUps:[],particles:[],damageTexts:[],keys:{w:!1,a:!1,s:!1,d:!1},mouseX:0,mouseY:0,spawnTimer:0,powerUpTimer:0,currentScore:0,shootCooldown:0,gameTime:0,currentEnemySpeed:te,currentEnemyHP:re,wave:1,enemiesKilled:0,combo:0,comboTimer:0});A.useEffect(()=>{if(F||ee)return;const w=new ge({width:p,height:k+u,backgroundColor:1710638});Z.current&&w.view instanceof Node&&Z.current.appendChild(w.view);const T=new le,d=new le;w.stage.addChild(T),w.stage.addChild(d);const R=new x;R.beginFill(986915),R.drawRect(0,0,p,u),R.endFill(),R.lineStyle(2,5090295),R.moveTo(0,u),R.lineTo(p,u),d.addChild(R);const _=new h("",{fill:16777215,fontSize:18,fontWeight:"bold"});_.x=20,_.y=15,d.addChild(_);const $=new h("",{fill:16697943,fontSize:16,fontWeight:"bold"});$.x=20,$.y=40,d.addChild($);const G=new h("",{fill:65535,fontSize:14,fontWeight:"bold"});G.x=20,G.y=65,d.addChild(G);const I=new h("",{fill:16777215,fontSize:14,fontWeight:"bold"});I.x=20,I.y=90,d.addChild(I);const O=new x;O.beginFill(3355443),O.drawRect(250,25,200,16),O.endFill(),d.addChild(O);const D=new x;d.addChild(D);const Y=new h("",{fill:16777215,fontSize:12,fontWeight:"bold"});Y.x=255,Y.y=27,d.addChild(Y);const L=new x;d.addChild(L);const H=new h("",{fill:65535,fontSize:10,fontWeight:"bold"});H.x=255,H.y=45,d.addChild(H);const X=new x;X.beginFill(3355443),X.drawRect(250,70,200,12),X.endFill(),d.addChild(X);const N=new x;d.addChild(N);const j=new h("",{fill:16697943,fontSize:10,fontWeight:"bold"});j.x=255,j.y=85,d.addChild(j);const q=new h("",{fill:16739179,fontSize:14,fontWeight:"bold"});q.x=520,q.y=15,d.addChild(q);const K=new h("",{fill:16776960,fontSize:14,fontWeight:"bold"});K.x=520,K.y=35,d.addChild(K);const U=new h("",{fill:16755200,fontSize:14,fontWeight:"bold"});U.x=520,U.y=55,d.addChild(U);const J=new h("",{fill:16755200,fontSize:14,fontWeight:"bold"});J.x=520,J.y=75,d.addChild(J);const Q=new h("",{fill:16777215,fontSize:14,fontWeight:"bold"});Q.x=p-120,Q.y=15,d.addChild(Q);const z=new h("",{fill:16711935,fontSize:16,fontWeight:"bold"});z.x=p-150,z.y=40,d.addChild(z);const y=new x;T.addChild(y);function xe(){const t=r.current.player;_.text=`Score: ${r.current.currentScore}`,$.text=`Level: ${t.level}`,G.text=`Wave: ${r.current.wave}`,I.text=`Kills: ${r.current.enemiesKilled}`,D.clear(),D.beginFill(65280),D.drawRect(250,25,200*(t.health/t.maxHealth),16),D.endFill(),Y.text=`HP: ${Math.ceil(t.health)}/${t.maxHealth}`,L.clear(),t.shield>0?(L.beginFill(65535),L.drawRect(250,45,t.shield/100*200,8),L.endFill(),H.text=`Shield: ${Math.ceil(t.shield)}`,H.visible=!0):H.visible=!1,N.clear(),N.beginFill(16697943),N.drawRect(250,70,200*(t.exp/t.expToNext),12),N.endFill(),j.text=`EXP: ${Math.floor(t.exp)}/${t.expToNext}`,q.text=`Damage: ${t.damage.toFixed(1)}`,K.text=`Multishot: ${t.multiShot}`,U.text=`Crit: ${(t.critChance*100).toFixed(1)}%`,J.text=`Crit Dmg: ${t.critDamage.toFixed(1)}x`,Q.text=`Time: ${Math.floor(r.current.gameTime/60)}s`,r.current.combo>1?(z.text=`COMBO x${r.current.combo}!`,z.visible=!0):z.visible=!1}function pe(){const t=Math.floor(Math.random()*4);let f,M;switch(t){case 0:f=Math.random()*p,M=u-20;break;case 1:f=p+20,M=Math.random()*k+u;break;case 2:f=Math.random()*p,M=k+u+20;break;case 3:f=-20,M=Math.random()*k+u;break;default:f=0,M=u}let v="normal",S=16729943,m=12,C=r.current.currentEnemySpeed,W=10,e=r.current.currentEnemyHP;const s=Math.random(),a=Math.floor(r.current.gameTime/1800);a>0&&s<.15?(v="fast",S=65416,m=10,C=r.current.currentEnemySpeed*1.8,W=8,e=Math.floor(r.current.currentEnemyHP*.7)):a>1&&s<.25?(v="tank",S=3355443,m=18,C=r.current.currentEnemySpeed*.6,W=20,e=Math.floor(r.current.currentEnemyHP*2.5)):a>2&&s<.3&&(v="bomber",S=16697943,m=14,C=r.current.currentEnemySpeed*1.2,W=30,e=r.current.currentEnemyHP);const i=new x;if(i.beginFill(S),i.drawCircle(0,0,m),i.endFill(),v==="fast"){i.lineStyle(2,16776960,.6);for(let b=0;b<3;b++){const g=Math.random()*Math.PI*2,c=Math.cos(g)*(m+5),l=Math.sin(g)*(m+5),P=c+Math.cos(g)*10,E=l+Math.sin(g)*10;i.moveTo(c,l),i.lineTo(P,E)}}else v==="tank"&&(i.lineStyle(3,6710886),i.drawCircle(0,0,m+3));const n=new x;i.addChild(n);const o=new h(v.charAt(0).toUpperCase(),{fill:16777215,fontSize:8,fontWeight:"bold"});o.anchor.set(.5),o.y=-m-20,i.addChild(o),i.x=f,i.y=M,T.addChild(i),r.current.enemies.push({x:f,y:M,hp:e,maxHp:e,radius:m,alive:!0,type:v,speed:C,damage:W,color:S,sprite:i})}function ye(){const t=r.current.player,f=r.current.keys;r.current.gameTime++;const M=Se*60,v=Math.floor(r.current.gameTime/M);r.current.currentEnemySpeed=te+v*.2,r.current.currentEnemyHP=Math.floor(re+v*1.5),F||(f.w&&t.y>t.radius+u&&(t.y-=V),f.s&&t.y<k+u-t.radius&&(t.y+=V),f.a&&t.x>t.radius&&(t.x-=V),f.d&&t.x<p-t.radius&&(t.x+=V)),y.clear(),t.shield>0&&(y.lineStyle(3,65535,.8),y.drawCircle(0,0,t.radius+5)),y.beginFill(5090295),y.drawCircle(0,0,t.radius),y.endFill();const S=r.current.mouseX-t.x,m=r.current.mouseY-t.y,C=Math.sqrt(S*S+m*m);if(C>0){const e=S/C,s=m/C;y.lineStyle(3,16777215),y.moveTo(0,0),y.lineTo(e*25,s*25)}y.x=t.x,y.y=t.y;const W=Math.max(10,ve-(t.level-1)*5);if(r.current.shootCooldown=Math.max(0,r.current.shootCooldown-1),r.current.shootCooldown===0&&C>0){const e=S/C,s=m/C;for(let a=0;a<t.multiShot;a++){const i=(a-(t.multiShot-1)/2)*.2,n=Math.cos(i),o=Math.sin(i),b=e*n-s*o,g=e*o+s*n,c=Math.random()<t.critChance,l=new x;c?(l.lineStyle(2,16776960,.8),l.beginFill(16755200),l.drawCircle(0,0,8)):(l.beginFill(16697943),l.drawCircle(0,0,4)),l.endFill(),l.x=t.x,l.y=t.y,T.addChild(l),r.current.bullets.push({x:t.x,y:t.y,vx:b*he,vy:g*he,radius:c?6:4,isCrit:c,piercing:t.level>5?1:0,sprite:l})}r.current.shootCooldown=W}if(r.current.bullets=r.current.bullets.filter(e=>{if(e.x+=e.vx,e.y+=e.vy,e.sprite&&(e.sprite.x=e.x,e.sprite.y=e.y,e.piercing>0&&Math.random()<.3)){const a=new x;a.beginFill(65535,.5),a.drawCircle(0,0,2),a.endFill(),a.x=e.x,a.y=e.y,T.addChild(a);const i=()=>{a.alpha-=.1,a.alpha<=0?a.destroy():requestAnimationFrame(i)};i()}const s=e.x>-10&&e.x<p+10&&e.y>u-10&&e.y<k+u+10;return!s&&e.sprite&&(e.sprite.destroy(),e.sprite=void 0),s}),r.current.enemies.forEach(e=>{if(!e.alive)return;const s=t.x-e.x,a=t.y-e.y,i=Math.sqrt(s*s+a*a);if(i>0){const n=s/i,o=a/i;e.x+=n*e.speed,e.y+=o*e.speed}if(e.sprite){e.sprite.x=e.x,e.sprite.y=e.y;const n=e.sprite.children[0];if(n&&(n.clear(),n.beginFill(3355443),n.drawRect(-15,-e.radius-10,30,4),n.endFill(),n.beginFill(16739179),n.drawRect(-15,-e.radius-10,30*(e.hp/e.maxHp),4),n.endFill()),e.type==="bomber"){const o=e.radius+Math.sin(Date.now()/200)*3;e.sprite.clear(),e.sprite.beginFill(e.color),e.sprite.drawCircle(0,0,e.radius),e.sprite.endFill(),e.sprite.lineStyle(2,16746496,.7),e.sprite.drawCircle(0,0,o)}}}),r.current.bullets=r.current.bullets.filter(e=>{let s=!1,a=e.piercing;return r.current.enemies.forEach(i=>{if(!i.alive)return;const n=e.x-i.x,o=e.y-i.y;if(Math.sqrt(n*n+o*o)<e.radius+i.radius){const g=e.isCrit?Math.floor(t.damage*t.critDamage):t.damage;i.hp-=g;const c=new h(g.toString(),{fill:e.isCrit?16697943:16777215,fontSize:e.isCrit?16:12,fontWeight:"bold",stroke:0,strokeThickness:2});c.anchor.set(.5),c.x=i.x,c.y=i.y-20,T.addChild(c),r.current.damageTexts.push({x:i.x,y:i.y-20,text:g.toString(),timer:60,color:e.isCrit?16697943:16777215,isCrit:e.isCrit,sprite:c});for(let l=0;l<(e.isCrit?8:4);l++){const P=l/(e.isCrit?8:4)*Math.PI*2,E=new x;E.beginFill(e.isCrit?16697943:i.color),E.drawCircle(0,0,e.isCrit?4:2),E.endFill(),E.x=i.x,E.y=i.y,T.addChild(E),r.current.particles.push({x:i.x,y:i.y,vx:Math.cos(P)*(2+Math.random()*3),vy:Math.sin(P)*(2+Math.random()*3),life:30,maxLife:30,color:e.isCrit?16697943:i.color,size:e.isCrit?4:2,alpha:1,sprite:E})}if(a<=0?s=!0:a--,i.hp<=0){i.alive=!1,r.current.currentScore+=i.type==="tank"?25:i.type==="bomber"?20:10,r.current.enemiesKilled++,r.current.combo++,r.current.comboTimer=180,ie(r.current.currentScore);const l=be*(i.type==="tank"?2:i.type==="bomber"?1.5:1);if(t.exp+=l,t.exp>=t.expToNext){t.level++,t.exp-=t.expToNext,t.expToNext=Math.floor(t.expToNext*1.2),t.damage++,t.maxHealth+=10,t.health=t.maxHealth;const P=Math.random();P<.3?t.multiShot++:P<.6?t.critChance=Math.min(.8,t.critChance+.05):t.critDamage+=.2}}}}),s&&e.sprite&&(e.sprite.destroy(),e.sprite=void 0),!s}),r.current.enemies.forEach(e=>{if(!e.alive)return;const s=t.x-e.x,a=t.y-e.y,i=Math.sqrt(s*s+a*a);if(i<t.radius+e.radius){let n=e.damage;if(t.shield>0){const c=Math.min(t.shield,n);t.shield-=c,n-=c}if(n>0){t.health-=n;const c=new h(`-${n}`,{fill:16729943,fontSize:12,fontWeight:"bold",stroke:0,strokeThickness:2});c.anchor.set(.5),c.x=t.x,c.y=t.y-20,T.addChild(c),r.current.damageTexts.push({x:t.x,y:t.y-20,text:`-${n}`,timer:60,color:16729943,isCrit:!1,sprite:c})}const o=5,b=s/i,g=a/i;e.x-=b*o,e.y-=g*o,t.health<=0&&(r.current.keys.w=!1,r.current.keys.a=!1,r.current.keys.s=!1,r.current.keys.d=!1,ne(!0))}}),r.current.enemies=r.current.enemies.filter(e=>(!e.alive&&e.sprite&&(e.sprite.destroy({children:!0}),e.sprite=void 0),e.alive)),r.current.particles=r.current.particles.filter(e=>(e.x+=e.vx,e.y+=e.vy,e.life--,e.vx*=.98,e.vy*=.98,e.alpha=e.life/e.maxLife,e.sprite&&(e.sprite.x=e.x,e.sprite.y=e.y,e.sprite.alpha=e.alpha),e.life<=0&&e.sprite&&(e.sprite.destroy(),e.sprite=void 0),e.life>0)),r.current.damageTexts=r.current.damageTexts.filter(e=>(e.timer--,e.y-=1,e.sprite&&(e.sprite.y=e.y,e.sprite.alpha=Math.max(0,e.timer/60)),e.timer<=0&&e.sprite&&(e.sprite.destroy(),e.sprite=void 0),e.timer>0)),r.current.comboTimer>0?r.current.comboTimer--:r.current.combo=0,r.current.powerUpTimer--,r.current.powerUpTimer<=0){const e=["health","damage","speed","multishot","shield"],s=e[Math.floor(Math.random()*e.length)],a=Math.random()*(p-40)+20,i=Math.random()*(k-40)+20+u,n=new x;let o=65280;switch(s){case"health":o=65280;break;case"damage":o=16711680;break;case"speed":o=255;break;case"multishot":o=16776960;break;case"shield":o=65535;break}n.beginFill(o),n.drawRect(-10,-10,20,20),n.endFill(),n.lineStyle(2,o,.8),n.drawRect(-12,-12,24,24);const b=new h(s.charAt(0).toUpperCase(),{fill:16777215,fontSize:12,fontWeight:"bold"});b.anchor.set(.5),n.addChild(b),n.x=a,n.y=i,T.addChild(n),r.current.powerUps.push({x:a,y:i,type:s,radius:12,size:20,active:!0,timer:Me,sprite:n}),r.current.powerUpTimer=Te}r.current.powerUps=r.current.powerUps.filter(e=>{if(!e.active||(e.timer--,e.timer<=0))return e.sprite&&(e.sprite.destroy(),e.sprite=void 0),!1;const s=t.x-e.x,a=t.y-e.y;if(Math.sqrt(s*s+a*a)<t.radius+e.radius){switch(e.type){case"health":t.health=Math.min(t.maxHealth,t.health+30);break;case"damage":t.damage+=2;break;case"speed":break;case"multishot":t.multiShot++;break;case"shield":t.shield+=50;break}return e.sprite&&(e.sprite.destroy(),e.sprite=void 0),!1}return!0}),r.current.spawnTimer--,r.current.spawnTimer<=0&&(pe(),r.current.spawnTimer=ue-Math.min(r.current.currentScore/10,80)),xe()}function se(t){if(!F)switch(t.key.toLowerCase()){case"w":r.current.keys.w=!0;break;case"a":r.current.keys.a=!0;break;case"s":r.current.keys.s=!0;break;case"d":r.current.keys.d=!0;break}}function oe(t){if(!F)switch(t.key.toLowerCase()){case"w":r.current.keys.w=!1;break;case"a":r.current.keys.a=!1;break;case"s":r.current.keys.s=!1;break;case"d":r.current.keys.d=!1;break}}function ce(t){if(!(w.view instanceof HTMLCanvasElement))return;const f=w.view.getBoundingClientRect();r.current.mouseX=t.clientX-f.left,r.current.mouseY=Math.max(t.clientY-f.top,u+10)}window.addEventListener("keydown",se),window.addEventListener("keyup",oe),w.view instanceof HTMLCanvasElement&&w.view.addEventListener("mousemove",ce),r.current.spawnTimer=ue;const de=()=>{F||(ye(),requestAnimationFrame(de))};return de(),()=>{window.removeEventListener("keydown",se),window.removeEventListener("keyup",oe),w.view instanceof HTMLCanvasElement&&w.view.removeEventListener("mousemove",ce),w.destroy(!0,{children:!0})}},[F,ee]);const me=()=>{ne(!1),ae(!1),ie(0),r.current.currentScore=0,r.current.enemies=[],r.current.bullets=[],r.current.powerUps=[],r.current.particles=[],r.current.damageTexts=[],r.current.gameTime=0,r.current.currentEnemySpeed=te,r.current.currentEnemyHP=re,r.current.wave=1,r.current.enemiesKilled=0,r.current.combo=0,r.current.comboTimer=0,r.current.player={x:p/2,y:(k+u)/2,radius:15,level:1,exp:0,expToNext:100,damage:1,health:100,maxHealth:100,shield:0,multiShot:1,critChance:.1,critDamage:2}};return ee?B.jsx(we,{title:"ðŸ¥” Brotato Style",description:"Sobrevive el mayor tiempo posible eliminando oleadas de enemigos y mejorando tus habilidades.",instructions:[{title:"Controles",items:["WASD: Mover jugador","Mouse: Apuntar (disparo automÃ¡tico)"],icon:"ðŸŽ®"},{title:"CaracterÃ­sticas",items:["Niveles: Gana EXP eliminando enemigos","Power-ups: Recoge mejoras (salud, daÃ±o, escudo, multidisparo)","CrÃ­ticos: Disparos que hacen mÃ¡s daÃ±o","Combos: Elimina enemigos consecutivamente","Escudo: ProtecciÃ³n temporal contra daÃ±o"],icon:"â­"}],theme:{background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",primary:"#4dabf7",secondary:"#feca57",accent:"#ff4757"},onStart:()=>ae(!1)}):F?B.jsx(Ce,{score:fe,onRestart:me,onMenu:()=>window.history.back(),theme:{background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",primaryColor:"#4dabf7",secondaryColor:"#feca57",accentColor:"#ff4757",titleGradient:"linear-gradient(45deg, #4dabf7, #74b9ff)",buttonGradient:"linear-gradient(45deg, #4dabf7, #74b9ff)"}}):B.jsxs("div",{style:{textAlign:"center",padding:"1rem"},children:[B.jsx("h1",{style:{marginBottom:"1rem",color:"#4dabf7"},children:"ðŸ¥” Brotato Style"}),B.jsx("div",{style:{marginBottom:"1rem",color:"#747d8c"},children:"Use WASD to move â€¢ Aim with mouse â€¢ Survive as long as you can!"}),B.jsx("div",{ref:Z,style:{display:"inline-block",border:"2px solid #4dabf7",borderRadius:"8px",overflow:"hidden"}})]})};export{Re as default};
