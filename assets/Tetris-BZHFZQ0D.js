import{r as m,A as O,j as F,G as v}from"./index-CJIMgKMy.js";const a=10,d=20,o=30,S=[65535,255,16753920,16776960,65280,16711680,8388736],k=[[[1,1,1,1]],[[1,0,0],[1,1,1]],[[0,0,1],[1,1,1]],[[1,1],[1,1]],[[0,1,1],[1,1,0]],[[0,1,0],[1,1,1]],[[1,1,0],[0,1,1]]];function A(){const f=Math.floor(Math.random()*k.length);return{shape:k[f],color:S[f],x:Math.floor(a/2)-1,y:0}}const M=()=>{const f=m.useRef(null);return m.useEffect(()=>{const i=new O({width:a*o,height:d*o,backgroundColor:2236962});f.current&&i.view instanceof Node&&f.current.appendChild(i.view);let s=Array.from({length:d},()=>Array(a).fill(null)),n=A(),h=!1;function g(){i.stage.removeChildren();for(let e=0;e<d;e++)for(let t=0;t<a;t++)if(s[e][t]!==null){const r=new v;r.beginFill(s[e][t]),r.drawRect(0,0,o-2,o-2),r.endFill(),r.x=t*o,r.y=e*o,i.stage.addChild(r)}for(let e=0;e<n.shape.length;e++)for(let t=0;t<n.shape[e].length;t++)if(n.shape[e][t]){const r=new v;r.beginFill(n.color),r.drawRect(0,0,o-2,o-2),r.endFill(),r.x=(n.x+t)*o,r.y=(n.y+e)*o,i.stage.addChild(r)}}function c(e=0,t=0,r=n.shape){for(let l=0;l<r.length;l++)for(let u=0;u<r[l].length;u++)if(r[l][u]){const y=n.x+u+e,w=n.y+l+t;if(y<0||y>=a||w>=d||w>=0&&s[w][y]!==null)return!0}return!1}function C(){for(let e=0;e<n.shape.length;e++)for(let t=0;t<n.shape[e].length;t++)if(n.shape[e][t]){const r=n.x+t,l=n.y+e;l>=0&&(s[l][r]=n.color)}}function R(e){return e[0].map((t,r)=>e.map(l=>l[r])).reverse()}function E(){let e=0;for(let t=d-1;t>=0;t--)s[t].every(r=>r!==null)&&(s.splice(t,1),s.unshift(Array(a).fill(null)),e++,t++);return e}let p=0,b=30;function L(){h||(p++,p>b&&(c(0,1)?(C(),E(),n=A(),c(0,0)&&(h=!0)):n.y++,p=0),g())}i.ticker.add(L);const x=e=>{if(!h){if(e.key==="ArrowLeft"&&!c(-1,0)&&n.x--,e.key==="ArrowRight"&&!c(1,0)&&n.x++,e.key==="ArrowDown"&&!c(0,1)&&n.y++,e.key==="ArrowUp"){const t=R(n.shape);c(0,0,t)||(n.shape=t)}g()}};return window.addEventListener("keydown",x),()=>{window.removeEventListener("keydown",x),i.destroy(!0,{children:!0})}},[]),F.jsx("div",{ref:f,style:{width:a*o,height:d*o,margin:"auto"}})};export{M as default};
