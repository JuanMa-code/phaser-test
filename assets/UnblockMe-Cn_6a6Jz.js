import{r as g,j as n}from"./index-DT6De0vj.js";import{P as m}from"./phaser-CtSIbetW.js";import{G as y,a as b}from"./GameOverScreen-DSWsITTW.js";const h=480,f=480,c=6,r=80,p=[[{id:0,x:1,y:2,width:2,height:1,color:16724787,direction:"horizontal",isTarget:!0},{id:1,x:3,y:1,width:1,height:3,color:4286945,direction:"vertical"},{id:2,x:0,y:0,width:2,height:1,color:3329330,direction:"horizontal"},{id:3,x:4,y:0,width:1,height:2,color:16766720,direction:"vertical"},{id:4,x:0,y:1,width:1,height:2,color:16738740,direction:"vertical"},{id:5,x:1,y:3,width:2,height:1,color:9055202,direction:"horizontal"},{id:6,x:4,y:4,width:2,height:1,color:52945,direction:"horizontal"}],[{id:0,x:0,y:2,width:2,height:1,color:16724787,direction:"horizontal",isTarget:!0},{id:1,x:2,y:0,width:1,height:3,color:4286945,direction:"vertical"},{id:2,x:3,y:0,width:2,height:1,color:3329330,direction:"horizontal"},{id:3,x:5,y:0,width:1,height:3,color:16766720,direction:"vertical"},{id:4,x:0,y:0,width:1,height:2,color:16738740,direction:"vertical"},{id:5,x:1,y:0,width:1,height:2,color:9055202,direction:"vertical"},{id:6,x:3,y:3,width:1,height:2,color:52945,direction:"vertical"},{id:7,x:4,y:3,width:1,height:2,color:16753920,direction:"vertical"},{id:8,x:0,y:4,width:3,height:1,color:9662683,direction:"horizontal"}]];class w extends m.GameObjects.Container{gridX;gridY;gridWidth;gridHeight;direction;isTarget;id;bg;constructor(i,t){super(i,t.x*r,t.y*r),this.id=t.id,this.gridX=t.x,this.gridY=t.y,this.gridWidth=t.width,this.gridHeight=t.height,this.direction=t.direction,this.isTarget=!!t.isTarget,this.bg=i.add.graphics(),this.draw(t.color),this.add(this.bg),this.setSize(t.width*r,t.height*r),this.setInteractive({draggable:!0}),i.add.existing(this)}draw(i){this.bg.clear(),this.bg.fillStyle(0,.2),this.bg.fillRoundedRect(4,4,this.width-8,this.height-8,8),this.bg.fillStyle(i),this.bg.fillRoundedRect(0,0,this.width-8,this.height-8,8),this.bg.fillStyle(16777215,.3),this.bg.fillRoundedRect(2,2,this.width-12,this.height/2-6,6),this.isTarget&&(this.bg.fillStyle(16777215),this.bg.fillCircle((this.width-8)/2,(this.height-8)/2,8),this.bg.fillStyle(i),this.bg.fillCircle((this.width-8)/2,(this.height-8)/2,5))}}class S extends m.Scene{blocks=[];currentLevelIndex=0;moves=0;isLevelComplete=!1;onMovesUpdate;onLevelComplete;constructor(i,t){super("UnblockMeScene"),this.onMovesUpdate=i,this.onLevelComplete=t}init(i){this.currentLevelIndex=i.level,this.moves=0,this.isLevelComplete=!1}create(){this.createBoard(),this.loadLevel(this.currentLevelIndex)}createBoard(){const i=this.add.graphics();i.fillStyle(9127187),i.fillRect(0,0,h,f),i.fillStyle(16113331),i.fillRoundedRect(0,0,h,f,0),i.lineStyle(1,13808780,.5);for(let t=0;t<=c;t++)i.moveTo(t*r,0),i.lineTo(t*r,f),i.moveTo(0,t*r),i.lineTo(h,t*r);i.strokePath(),i.lineStyle(4,16724787),i.fillStyle(16724787,.3),i.fillRect(h-10,2*r+10,10,r-20),i.strokeRect(h-10,2*r+10,10,r-20)}loadLevel(i){this.blocks.forEach(s=>s.destroy()),this.blocks=[],p[i].forEach(s=>{const e=new w(this,s);e.on("dragstart",()=>{this.children.bringToTop(e),e.startX=e.x,e.startY=e.y,e.startGridX=e.gridX,e.startGridY=e.gridY}),e.on("drag",(l,o,u)=>{if(!this.isLevelComplete)if(e.direction==="horizontal"){e.y=e.gridY*r;const a=Math.round(o/r);this.isValidMove(e,a,e.gridY)&&(e.x=Math.max(0,Math.min((c-e.gridWidth)*r,o)))}else{e.x=e.gridX*r;const a=Math.round(u/r);this.isValidMove(e,e.gridX,a)&&(e.y=Math.max(0,Math.min((c-e.gridHeight)*r,u)))}}),e.on("dragend",()=>{if(this.isLevelComplete)return;const l=Math.round(e.x/r),o=Math.round(e.y/r);e.x=l*r,e.y=o*r,(l!==e.startGridX||o!==e.startGridY)&&(e.gridX=l,e.gridY=o,this.moves++,this.onMovesUpdate(this.moves),this.checkWin())}),this.blocks.push(e)})}isValidMove(i,t,s){if(t<0||s<0||t+i.gridWidth>c||s+i.gridHeight>c)return!1;for(const e of this.blocks)if(e!==i&&t<e.gridX+e.gridWidth&&t+i.gridWidth>e.gridX&&s<e.gridY+e.gridHeight&&s+i.gridHeight>e.gridY)return!1;return!0}checkWin(){const i=this.blocks.find(t=>t.isTarget);i&&i.gridX+i.gridWidth===c&&(this.isLevelComplete=!0,this.onLevelComplete(this.moves))}}const R=()=>{const[d,i]=g.useState("start"),[t,s]=g.useState(0),[e,l]=g.useState(0),o=g.useRef(null);g.useEffect(()=>{if(d==="playing"){const x={type:m.AUTO,width:h,height:f,parent:"phaser-game",backgroundColor:"#2C1810",scene:new S(v=>l(v),v=>{l(v),i("levelComplete")})};return o.current=new m.Game(x),o.current.events.on("ready",()=>{o.current&&o.current.scene.getScene("UnblockMeScene").scene.restart({level:t})}),()=>{o.current&&(o.current.destroy(!0),o.current=null)}}},[d,t]);const u=()=>{s(0),l(0),i("playing")},a=()=>{t<p.length-1?(s(x=>x+1),l(0),i("playing")):i("start")};return d==="start"?n.jsx(y,{title:"ðŸ§© UNBLOCK ME",description:"Libera el bloque rojo moviendo los demÃ¡s",instructions:[{title:"Mover",items:["Arrastra los bloques para moverlos"],icon:"ðŸ–±ï¸"},{title:"Objetivo",items:["Lleva el bloque rojo a la salida derecha"],icon:"ðŸŽ¯"}],onStart:u}):d==="levelComplete"?n.jsx(b,{score:e,isVictory:!0,onRestart:()=>{l(0),i("playing")},onMenu:()=>i("start"),customStats:[{label:"Nivel",value:t+1},{label:"Movimientos",value:e}],customButtons:t<p.length-1?n.jsx("button",{onClick:a,style:{padding:"10px 20px",fontSize:"1.2rem",background:"#4CAF50",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",marginTop:"10px"},children:"Siguiente Nivel âž¡ï¸"}):void 0}):n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",background:"#8B4513",minHeight:"100dvh",color:"white"},children:[n.jsx("h1",{style:{margin:"0 0 20px 0"},children:"ðŸ§© UNBLOCK ME"}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:h,marginBottom:"10px",fontSize:"1.2rem",fontWeight:"bold"},children:[n.jsxs("span",{children:["Nivel: ",t+1]}),n.jsxs("span",{children:["Movimientos: ",e]})]}),n.jsx("div",{id:"phaser-game",style:{border:"4px solid #5D4037",borderRadius:"10px",overflow:"hidden"}}),n.jsx("div",{style:{marginTop:"20px"},children:"Arrastra los bloques para liberar el camino"})]})};export{R as default};
