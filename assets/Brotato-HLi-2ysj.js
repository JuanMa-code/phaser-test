import{r as g,j as T}from"./index-DT6De0vj.js";import{P as p}from"./phaser-CtSIbetW.js";import{G as B,a as P}from"./GameOverScreen-DSWsITTW.js";const f=1e3,S=700,n=120,D=4,E=8,M=.5,C=120,G=60,U=20,R=15,v=3,k=1800,A=600;class O extends p.Scene{player;playerGraphics;bullets;enemies;powerUps;particles;damageTexts;cursors;wasd;playerState={level:1,exp:0,expToNext:100,damage:1,health:100,maxHealth:100,shield:0,multiShot:1,critChance:.1,critDamage:2};score=0;gameTime=0;spawnTimer=0;powerUpTimer=0;shootCooldown=0;currentEnemySpeed=M;currentEnemyHP=v;wave=1;enemiesKilled=0;combo=0;comboTimer=0;scoreText;levelText;waveText;killsText;healthBar;healthText;shieldBar;shieldText;expBar;expText;statsText;timeText;comboText;onGameOver;constructor(e){super("BrotatoScene"),this.onGameOver=e}create(){this.cameras.main.setBackgroundColor("#1a1a2e"),this.input.keyboard&&(this.cursors=this.input.keyboard.createCursorKeys(),this.wasd=this.input.keyboard.addKeys("W,A,S,D")),this.bullets=this.add.group(),this.enemies=this.add.group(),this.powerUps=this.add.group(),this.particles=this.add.group(),this.damageTexts=this.add.group(),this.player=this.add.container(f/2,(S+n)/2),this.playerGraphics=this.add.graphics(),this.player.add(this.playerGraphics),this.drawPlayer(),this.createUI(),this.spawnTimer=C,this.powerUpTimer=k}update(){this.gameTime++,this.handleInput(),this.updatePlayer(),this.handleShooting(),this.updateBullets(),this.updateEnemies(),this.checkCollisions(),this.updateParticles(),this.updateDamageTexts(),this.updatePowerUps(),this.updateUI(),this.handleSpawning(),this.handleDifficulty()}createUI(){const e=this.add.graphics();e.fillStyle(986915),e.fillRect(0,0,f,n),e.lineStyle(2,5090295),e.beginPath(),e.moveTo(0,n),e.lineTo(f,n),e.strokePath();const t={fontFamily:"Arial",fontSize:"18px",color:"#ffffff",fontStyle:"bold"};this.scoreText=this.add.text(20,15,"Score: 0",t),this.levelText=this.add.text(20,40,"Level: 1",{...t,color:"#feca57",fontSize:"16px"}),this.waveText=this.add.text(20,65,"Wave: 1",{...t,color:"#00ffff",fontSize:"14px"}),this.killsText=this.add.text(20,90,"Kills: 0",{...t,fontSize:"14px"}),this.healthBar=this.add.graphics(),this.healthText=this.add.text(255,27,"",{...t,fontSize:"12px"}),this.shieldBar=this.add.graphics(),this.shieldText=this.add.text(255,45,"",{...t,color:"#00ffff",fontSize:"10px"}),this.expBar=this.add.graphics(),this.expText=this.add.text(255,85,"",{...t,color:"#feca57",fontSize:"10px"}),this.statsText=this.add.text(520,15,"",{...t,fontSize:"14px"}),this.timeText=this.add.text(f-120,15,"",{...t,fontSize:"14px"}),this.comboText=this.add.text(f-150,40,"",{...t,color:"#ff00ff",fontSize:"16px"}),this.comboText.setVisible(!1)}drawPlayer(){this.playerGraphics.clear(),this.playerState.shield>0&&(this.playerGraphics.lineStyle(3,65535,.8),this.playerGraphics.strokeCircle(0,0,20)),this.playerGraphics.fillStyle(5090295),this.playerGraphics.fillCircle(0,0,15);const e=this.input.activePointer,t=e.x-this.player.x,s=e.y-this.player.y,i=Math.sqrt(t*t+s*s);if(i>0){const r=t/i,a=s/i;this.playerGraphics.lineStyle(3,16777215),this.playerGraphics.beginPath(),this.playerGraphics.moveTo(0,0),this.playerGraphics.lineTo(r*25,a*25),this.playerGraphics.strokePath()}}handleInput(){let e=0,t=0;if((this.wasd.W.isDown||this.cursors.up.isDown)&&(t-=1),(this.wasd.S.isDown||this.cursors.down.isDown)&&(t+=1),(this.wasd.A.isDown||this.cursors.left.isDown)&&(e-=1),(this.wasd.D.isDown||this.cursors.right.isDown)&&(e+=1),e!==0||t!==0){const s=Math.sqrt(e*e+t*t);e/=s,t/=s,this.player.x+=e*D,this.player.y+=t*D,this.player.x=p.Math.Clamp(this.player.x,15,f-15),this.player.y=p.Math.Clamp(this.player.y,n+15,S+n-15)}}updatePlayer(){this.drawPlayer()}handleShooting(){if(this.shootCooldown=Math.max(0,this.shootCooldown-1),this.shootCooldown===0){const e=this.input.activePointer,t=e.x-this.player.x,s=e.y-this.player.y,i=Math.sqrt(t*t+s*s);if(i>0){const r=t/i,a=s/i,l=Math.max(10,G-(this.playerState.level-1)*5);for(let o=0;o<this.playerState.multiShot;o++){const c=(o-(this.playerState.multiShot-1)/2)*.2,d=Math.cos(c),y=Math.sin(c),m=r*d-a*y,h=r*y+a*d,b=Math.random()<this.playerState.critChance,x=this.add.graphics();b?(x.lineStyle(2,16776960,.8),x.fillStyle(16755200),x.fillCircle(0,0,8),x.strokeCircle(0,0,8)):(x.fillStyle(16697943),x.fillCircle(0,0,4));const u=this.add.container(this.player.x,this.player.y);u.add(x),u.setData("vx",m*E),u.setData("vy",h*E),u.setData("isCrit",b),u.setData("piercing",this.playerState.level>5?1:0),u.setData("radius",b?6:4),this.bullets.add(u)}this.shootCooldown=l}}}updateBullets(){this.bullets.getChildren().forEach(e=>{const t=e;if(t.x+=t.getData("vx"),t.y+=t.getData("vy"),t.getData("piercing")>0&&Math.random()<.3){const s=this.add.graphics();s.fillStyle(65535,.5),s.fillCircle(t.x,t.y,2),this.tweens.add({targets:s,alpha:0,duration:500,onComplete:()=>s.destroy()})}(t.x<-10||t.x>f+10||t.y<n-10||t.y>S+n+10)&&t.destroy()})}handleSpawning(){this.spawnTimer--,this.spawnTimer<=0&&(this.spawnEnemy(),this.spawnTimer=C-Math.min(this.score/10,80))}spawnEnemy(){const e=p.Math.Between(0,3);let t=0,s=0;switch(e){case 0:t=p.Math.Between(0,f),s=n-20;break;case 1:t=f+20,s=p.Math.Between(n,S+n);break;case 2:t=p.Math.Between(0,f),s=S+n+20;break;case 3:t=-20,s=p.Math.Between(n,S+n);break}let i="normal",r=16729943,a=12,l=this.currentEnemySpeed,o=10,c=this.currentEnemyHP;const d=Math.random(),y=Math.floor(this.gameTime/1800);y>0&&d<.15?(i="fast",r=65416,a=10,l*=1.8,o=8,c=Math.floor(c*.7)):y>1&&d<.25?(i="tank",r=3355443,a=18,l*=.6,o=20,c=Math.floor(c*2.5)):y>2&&d<.3&&(i="bomber",r=16697943,a=14,l*=1.2,o=30);const m=this.add.container(t,s),h=this.add.graphics();h.fillStyle(r),h.fillCircle(0,0,a),i==="fast"?(h.lineStyle(2,16776960,.6),h.beginPath(),h.moveTo(a,0),h.lineTo(a+5,0),h.moveTo(-a,0),h.lineTo(-(a+5),0),h.moveTo(0,a),h.lineTo(0,a+5),h.moveTo(0,-a),h.lineTo(0,-(a+5)),h.strokePath()):i==="tank"&&(h.lineStyle(3,6710886),h.strokeCircle(0,0,a+3));const b=this.add.graphics(),x=this.add.text(0,-a-20,i.charAt(0).toUpperCase(),{fontSize:"8px",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5);m.add([h,b,x]),m.setData("type",i),m.setData("hp",c),m.setData("maxHp",c),m.setData("speed",l),m.setData("damage",o),m.setData("radius",a),m.setData("color",r),this.enemies.add(m)}updateEnemies(){this.enemies.getChildren().forEach(e=>{const t=e,s=t.getData("speed"),i=this.player.x-t.x,r=this.player.y-t.y,a=Math.sqrt(i*i+r*r);a>0&&(t.x+=i/a*s,t.y+=r/a*s);const l=t.list[1],o=t.getData("hp"),c=t.getData("maxHp"),d=t.getData("radius");if(l.clear(),l.fillStyle(3355443),l.fillRect(-15,-d-10,30,4),l.fillStyle(16739179),l.fillRect(-15,-d-10,30*(o/c),4),t.getData("type")==="bomber"){const y=t.list[0];y.clear(),y.fillStyle(t.getData("color")),y.fillCircle(0,0,d),y.lineStyle(2,16746496,.7),y.strokeCircle(0,0,d+Math.sin(this.gameTime/10)*3)}})}checkCollisions(){this.bullets.getChildren().forEach(e=>{const t=e;let s=t.getData("piercing"),i=!1;this.enemies.getChildren().forEach(r=>{if(i)return;const a=r,l=t.x-a.x,o=t.y-a.y,c=Math.sqrt(l*l+o*o),d=t.getData("radius")+a.getData("radius");c<d&&(this.damageEnemy(a,t.getData("isCrit")),s<=0?(t.destroy(),i=!0):s--)})}),this.enemies.getChildren().forEach(e=>{const t=e,s=this.player.x-t.x,i=this.player.y-t.y,r=Math.sqrt(s*s+i*i),a=15+t.getData("radius");if(r<a){this.damagePlayer(t.getData("damage"));const l=5;t.x-=s/r*l,t.y-=i/r*l}})}damageEnemy(e,t){let s=this.playerState.damage;t&&(s=Math.floor(s*this.playerState.critDamage));let i=e.getData("hp");i-=s,e.setData("hp",i);const r=this.add.text(e.x,e.y-20,s.toString(),{fontSize:t?"16px":"12px",color:t?"#feca57":"#ffffff",fontStyle:"bold",stroke:"#000000",strokeThickness:2}).setOrigin(.5);this.tweens.add({targets:r,y:r.y-30,alpha:0,duration:1e3,onComplete:()=>r.destroy()});for(let a=0;a<(t?8:4);a++){const l=this.add.circle(e.x,e.y,t?4:2,t?16697943:e.getData("color")),o=Math.random()*Math.PI*2;this.tweens.add({targets:l,x:l.x+Math.cos(o)*30,y:l.y+Math.sin(o)*30,alpha:0,duration:500,onComplete:()=>l.destroy()})}i<=0&&this.killEnemy(e)}killEnemy(e){const t=e.getData("type"),s=t==="tank"?25:t==="bomber"?20:10,i=R*(t==="tank"?2:t==="bomber"?1.5:1);this.score+=s,this.enemiesKilled++,this.combo++,this.comboTimer=180,this.playerState.exp+=i,this.playerState.exp>=this.playerState.expToNext&&this.levelUp(),e.destroy()}levelUp(){this.playerState.level++,this.playerState.exp-=this.playerState.expToNext,this.playerState.expToNext=Math.floor(this.playerState.expToNext*1.2),this.playerState.damage++,this.playerState.maxHealth+=10,this.playerState.health=this.playerState.maxHealth;const e=Math.random();e<.3?this.playerState.multiShot++:e<.6?this.playerState.critChance=Math.min(.8,this.playerState.critChance+.05):this.playerState.critDamage+=.2}damagePlayer(e){if(this.playerState.shield>0){const t=Math.min(this.playerState.shield,e);this.playerState.shield-=t,e-=t}if(e>0){this.playerState.health-=e;const t=this.add.text(this.player.x,this.player.y-20,`-${e}`,{fontSize:"12px",color:"#ff4757",fontStyle:"bold",stroke:"#000000",strokeThickness:2}).setOrigin(.5);this.tweens.add({targets:t,y:t.y-30,alpha:0,duration:1e3,onComplete:()=>t.destroy()}),this.playerState.health<=0&&(this.scene.pause(),this.onGameOver(this.score))}}updatePowerUps(){if(this.powerUpTimer--,this.powerUpTimer<=0){const e=["health","damage","speed","multishot","shield"],t=e[p.Math.Between(0,e.length-1)],s=p.Math.Between(20,f-20),i=p.Math.Between(n+20,S+n-20);let r=65280;t==="damage"?r=16711680:t==="speed"?r=255:t==="multishot"?r=16776960:t==="shield"&&(r=65535);const a=this.add.container(s,i),l=this.add.graphics();l.fillStyle(r),l.fillRect(-10,-10,20,20),l.lineStyle(2,r,.8),l.strokeRect(-12,-12,24,24);const o=this.add.text(0,0,t.charAt(0).toUpperCase(),{fontSize:"12px",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5);a.add([l,o]),a.setData("type",t),a.setData("timer",A),this.powerUps.add(a),this.powerUpTimer=k}this.powerUps.getChildren().forEach(e=>{const t=e;let s=t.getData("timer");if(s--,t.setData("timer",s),s<=0){t.destroy();return}const i=this.player.x-t.x,r=this.player.y-t.y;if(Math.sqrt(i*i+r*r)<27){switch(t.getData("type")){case"health":this.playerState.health=Math.min(this.playerState.maxHealth,this.playerState.health+30);break;case"damage":this.playerState.damage+=2;break;case"multishot":this.playerState.multiShot++;break;case"shield":this.playerState.shield+=50;break}t.destroy()}})}updateParticles(){}updateDamageTexts(){}updateUI(){this.scoreText.setText(`Score: ${this.score}`),this.levelText.setText(`Level: ${this.playerState.level}`),this.waveText.setText(`Wave: ${this.wave}`),this.killsText.setText(`Kills: ${this.enemiesKilled}`),this.healthBar.clear(),this.healthBar.fillStyle(3355443),this.healthBar.fillRect(250,25,200,16),this.healthBar.fillStyle(65280),this.healthBar.fillRect(250,25,200*(this.playerState.health/this.playerState.maxHealth),16),this.healthText.setText(`HP: ${Math.ceil(this.playerState.health)}/${this.playerState.maxHealth}`),this.shieldBar.clear(),this.playerState.shield>0?(this.shieldBar.fillStyle(65535),this.shieldBar.fillRect(250,45,this.playerState.shield/100*200,8),this.shieldText.setText(`Shield: ${Math.ceil(this.playerState.shield)}`),this.shieldText.setVisible(!0)):this.shieldText.setVisible(!1),this.expBar.clear(),this.expBar.fillStyle(3355443),this.expBar.fillRect(250,70,200,12),this.expBar.fillStyle(16697943),this.expBar.fillRect(250,70,200*(this.playerState.exp/this.playerState.expToNext),12),this.expText.setText(`EXP: ${Math.floor(this.playerState.exp)}/${this.playerState.expToNext}`),this.statsText.setText(`Damage: ${this.playerState.damage.toFixed(1)}
Multishot: ${this.playerState.multiShot}
Crit: ${(this.playerState.critChance*100).toFixed(1)}%
Crit Dmg: ${this.playerState.critDamage.toFixed(1)}x`),this.statsText.setColor("#ff6b6b"),this.timeText.setText(`Time: ${Math.floor(this.gameTime/60)}s`),this.combo>1?(this.comboText.setText(`COMBO x${this.combo}!`),this.comboText.setVisible(!0),this.comboTimer--,this.comboTimer<=0&&(this.combo=0)):this.comboText.setVisible(!1)}handleDifficulty(){const e=U*60,t=Math.floor(this.gameTime/e);this.currentEnemySpeed=M+t*.2,this.currentEnemyHP=Math.floor(v+t*1.5)}}const I=()=>{const w=g.useRef(null),e=g.useRef(null),[t,s]=g.useState(!1),[i,r]=g.useState(0),[a,l]=g.useState(!0);g.useEffect(()=>{if(a||t)return;const c={type:p.AUTO,width:f,height:S+n,parent:w.current||void 0,backgroundColor:"#1a1a2e",scene:new O(d=>{r(d),s(!0)})};return e.current=new p.Game(c),()=>{e.current&&(e.current.destroy(!0),e.current=null)}},[a,t]);const o=()=>{s(!1),l(!1),r(0)};return a?T.jsx(B,{title:"ðŸ¥” Brotato Style",description:"Sobrevive el mayor tiempo posible eliminando oleadas de enemigos y mejorando tus habilidades.",instructions:[{title:"Controles",items:["WASD: Mover jugador","Mouse: Apuntar (disparo automÃ¡tico)"],icon:"ðŸŽ®"},{title:"CaracterÃ­sticas",items:["Niveles: Gana EXP eliminando enemigos","Power-ups: Recoge mejoras (salud, daÃ±o, escudo, multidisparo)","CrÃ­ticos: Disparos que hacen mÃ¡s daÃ±o","Combos: Elimina enemigos consecutivamente","Escudo: ProtecciÃ³n temporal contra daÃ±o"],icon:"â­"}],theme:{background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",primary:"#4dabf7",secondary:"#feca57",accent:"#ff4757"},onStart:()=>l(!1)}):t?T.jsx(P,{score:i,onRestart:o,onMenu:()=>window.history.back(),theme:{background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",primaryColor:"#4dabf7",secondaryColor:"#feca57",accentColor:"#ff4757",titleGradient:"linear-gradient(45deg, #4dabf7, #74b9ff)",buttonGradient:"linear-gradient(45deg, #4dabf7, #74b9ff)"}}):T.jsxs("div",{style:{textAlign:"center",padding:"1rem"},children:[T.jsx("h1",{style:{marginBottom:"1rem",color:"#4dabf7"},children:"ðŸ¥” Brotato Style"}),T.jsx("div",{style:{marginBottom:"1rem",color:"#747d8c"},children:"Use WASD to move â€¢ Aim with mouse â€¢ Survive as long as you can!"}),T.jsx("div",{ref:w,style:{display:"inline-block",border:"2px solid #4dabf7",borderRadius:"8px",overflow:"hidden"}})]})};export{I as default};
