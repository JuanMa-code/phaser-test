import{r as h,j as s}from"./index-CC8smfP6.js";const i=1e3,n=600,j=15,X=6,y=80,re=()=>{const D=h.useRef(null),I=h.useRef(void 0),[B,P]=h.useState(!0),[A,O]=h.useState(0),[d,g]=h.useState({gameStarted:!1,currentHalf:1,timeLeft:300,blueScore:0,redScore:0,isCountdown:!1,countdownValue:3,showGoal:!1}),l=h.useRef(d),w=h.useRef([]),b=h.useRef({x:i/2,y:n/2,vx:0,vy:0}),M=h.useRef({});h.useEffect(()=>{l.current=d},[d]),h.useEffect(()=>{let e;return d.gameStarted&&d.timeLeft>0&&!d.isCountdown&&(e=setInterval(()=>{g(t=>{const o=t.timeLeft-1;return o<=0?t.currentHalf===1?(setTimeout(()=>{Z(),E(),b.current={x:i/2,y:n/2,vx:0,vy:0},l.current={...l.current,currentHalf:2,timeLeft:300,isCountdown:!0,countdownValue:3,gameStarted:!1},g({...l.current}),k(()=>{l.current.gameStarted=!0,g({...l.current})})},1e3),{...t,currentHalf:2,timeLeft:300,gameStarted:!1,isCountdown:!0,countdownValue:3,showGoal:!1}):{...t,gameStarted:!1,timeLeft:0}:{...t,timeLeft:o}})},1e3)),()=>{e&&clearInterval(e)}},[d.gameStarted,d.timeLeft,d.isCountdown]),h.useEffect(()=>{d.currentHalf===2&&d.timeLeft===300&&d.gameStarted&&!d.isCountdown&&console.log("Handling halftime transition")},[d.currentHalf,d.timeLeft]);const E=()=>{w.current.forEach(e=>{e.x=e.originalX,e.y=e.originalY})},k=e=>{console.log("Starting countdown..."),l.current.isCountdown=!0,l.current.countdownValue=3,g({...l.current});let t=3;const o=setInterval(()=>{t--,console.log("Countdown:",t),l.current.countdownValue=t,g({...l.current}),t<=0&&(clearInterval(o),l.current.isCountdown=!1,l.current.showGoal=!1,g({...l.current}),console.log("Countdown finished"),e&&e())},1e3)},L=e=>{console.log("Starting goal countdown..."),l.current.isCountdown=!0,l.current.countdownValue=3,l.current.showGoal=!0,g({...l.current});let t=3;const o=setInterval(()=>{t--,console.log("Goal countdown:",t),l.current.countdownValue=t,g({...l.current}),t<=0&&(clearInterval(o),l.current.isCountdown=!1,l.current.showGoal=!1,g({...l.current}),console.log("Goal countdown finished"))},1e3)},H=e=>{const t=Math.floor(e/60),o=e%60;return`${t}:${o.toString().padStart(2,"0")}`},Z=()=>{w.current.forEach(e=>{e.x=i-e.x,e.originalX=i-e.originalX,e.team=e.team==="blue"?"red":"blue",e.actionZone=C(e.position,e.team)})},C=(e,t)=>{const o=t==="blue",a=i/3;switch(e){case"GK":return o?{minX:10,maxX:a*.5,minY:50,maxY:n-50}:{minX:a*2.5,maxX:i-10,minY:50,maxY:n-50};case"DEF":return o?{minX:10,maxX:a*1.5,minY:20,maxY:n-20}:{minX:a*1.5,maxX:i-10,minY:20,maxY:n-20};case"MID":return o?{minX:a*.6,maxX:a*2.9,minY:20,maxY:n-20}:{minX:a*.1,maxX:a*2.4,minY:20,maxY:n-20};case"ATT":return o?{minX:a*1.5,maxX:i-10,minY:20,maxY:n-20}:{minX:10,maxX:a*1.5,minY:20,maxY:n-20};default:return{minX:20,maxX:i-20,minY:20,maxY:n-20}}},z=h.useCallback(()=>{const e=[],t=[{x:80,y:n/2,pos:"GK"},{x:180,y:n*.3,pos:"DEF"},{x:180,y:n*.7,pos:"DEF"},{x:280,y:n*.25,pos:"MID"},{x:280,y:n*.75,pos:"MID"},{x:380,y:n/2,pos:"ATT"}],o=[{x:i-80,y:n/2,pos:"GK"},{x:i-180,y:n*.3,pos:"DEF"},{x:i-180,y:n*.7,pos:"DEF"},{x:i-280,y:n*.25,pos:"MID"},{x:i-280,y:n*.75,pos:"MID"},{x:i-380,y:n/2,pos:"ATT"}];t.forEach((a,r)=>{const c=C(a.pos,"blue");e.push({id:r,x:a.x,y:a.y,team:"blue",position:a.pos,isControlledByUser:r===A,originalX:a.x,originalY:a.y,speed:a.pos==="GK"?2.5:a.pos==="DEF"?3:a.pos==="MID"?3.5:3.2,actionZone:c})}),o.forEach((a,r)=>{const c=C(a.pos,"red");e.push({id:r+6,x:a.x,y:a.y,team:"red",position:a.pos,isControlledByUser:!1,originalX:a.x,originalY:a.y,speed:a.pos==="GK"?2.5:a.pos==="DEF"?3:a.pos==="MID"?3.5:3.2,actionZone:c})}),w.current=e},[A]),W=e=>{e.fillStyle="#228B22",e.fillRect(0,0,i,n),e.strokeStyle="#FFFFFF",e.lineWidth=3,e.strokeRect(10,10,i-20,n-20),e.beginPath(),e.moveTo(i/2,10),e.lineTo(i/2,n-10),e.stroke(),e.beginPath(),e.arc(i/2,n/2,60,0,Math.PI*2),e.stroke(),e.strokeRect(10,n/2-100,120,200),e.strokeRect(10,n/2-50,50,100),e.strokeRect(i-130,n/2-100,120,200),e.strokeRect(i-60,n/2-50,50,100),e.lineWidth=4,e.beginPath(),e.moveTo(10,n/2-y/2),e.lineTo(-5,n/2-y/2),e.lineTo(-5,n/2+y/2),e.lineTo(10,n/2+y/2),e.stroke(),e.beginPath(),e.moveTo(i-10,n/2-y/2),e.lineTo(i+5,n/2-y/2),e.lineTo(i+5,n/2+y/2),e.lineTo(i-10,n/2+y/2),e.stroke()},K=(e,t)=>{const o=t.team==="blue"?"#0066FF":"#FF0000",a=t.isControlledByUser?"#FFFF00":"#000000";e.fillStyle=o,e.strokeStyle=a,e.lineWidth=t.isControlledByUser?3:1,e.beginPath(),e.arc(t.x,t.y,j,0,Math.PI*2),e.fill(),e.stroke(),e.fillStyle="#FFFFFF",e.font="bold 10px Arial",e.textAlign="center",e.fillText(t.id.toString(),t.x,t.y+3)},U=(e,t)=>{e.fillStyle="#FFFFFF",e.strokeStyle="#000000",e.lineWidth=1,e.beginPath(),e.arc(t.x,t.y,X,0,Math.PI*2),e.fill(),e.stroke()},p=(e,t,o,a)=>Math.sqrt((o-e)**2+(a-t)**2),V=(e,t,o)=>{if(p(e.x,e.y,t,o)>3){const r=e.position==="GK"?1.5:e.position==="DEF"?2:e.position==="MID"?2.5:3,c=Math.atan2(o-e.y,t-e.x);e.x+=Math.cos(c)*r,e.y+=Math.sin(c)*r,e.x=Math.max(20,Math.min(i-20,e.x)),e.y=Math.max(20,Math.min(n-20,e.y))}},q=(e,t)=>{const o=e.actionZone;return t.x>=o.minX&&t.x<=o.maxX&&t.y>=o.minY&&t.y<=o.maxY},N=(e,t)=>{const{position:o,team:a,actionZone:r,originalX:c,originalY:u}=e,x=a==="blue",f=x?t.x<i/2:t.x>i/2;switch(o){case"GK":const G=Math.max(r.minY,Math.min(r.maxY,t.y));return{x:c,y:G};case"DEF":if(f){const m=x?30:i-30,F=Math.abs(t.x-m),v=Math.max(.3,1-F/(i/2)),te=x?c-70*v:c+70*v,ne=u+(t.y-n/2)*.4;return{x:Math.max(r.minX,Math.min(r.maxX,te)),y:Math.max(r.minY,Math.min(r.maxY,ne))}}else{const m=x?c+80:c-80;return{x:Math.max(r.minX,Math.min(r.maxX,m)),y:u}}case"MID":let S,T;if(f)S=x?c-60:c+60,T=u+(t.y-n/2)*.4;else{const m=x?c+150:c-150;S=m,T=u+(t.y-n/2)*.6,w.current.find(v=>v.team===a&&v.position==="ATT"&&p(v.x,v.y,t.x,t.y)<120)&&(S=x?Math.min(r.maxX,m+50):Math.max(r.minX,m-50))}return{x:Math.max(r.minX,Math.min(r.maxX,S)),y:Math.max(r.minY,Math.min(r.maxY,T))};case"ATT":if(f){const m=x?c+30:c-30;return{x:Math.max(r.minX,Math.min(r.maxX,m)),y:u}}else{const m=x?Math.min(r.maxX,t.x+50):Math.max(r.minX,t.x-50),F=u+(t.y-n/2)*.5;return{x:Math.max(r.minX,Math.min(r.maxX,m)),y:Math.max(r.minY,Math.min(r.maxY,F))}}default:return{x:c,y:u}}},_=()=>{const e=b.current;w.current.forEach(t=>{if(t.isControlledByUser)return;const o=p(t.x,t.y,e.x,e.y),a=q(t,e),r=N(t,e);let c=r.x,u=r.y;a&&(o<100?(c=e.x,u=e.y):o<200&&(c=t.x+(e.x-t.x)*.6,u=t.y+(e.y-t.y)*.6,c=Math.max(t.actionZone.minX,Math.min(t.actionZone.maxX,c)),u=Math.max(t.actionZone.minY,Math.min(t.actionZone.maxY,u)))),w.current.filter(f=>!f.isControlledByUser&&f.team===t.team&&f.id!==t.id&&p(f.x,f.y,e.x,e.y)<80).length>=2&&o>60&&(c=r.x,u=r.y),V(t,c,u)})},J=()=>{const e=b.current;e.vx*=.985,e.vy*=.985,e.x+=e.vx,e.y+=e.vy,(e.y<=20||e.y>=n-20)&&(e.vy*=-.7,e.y=Math.max(20,Math.min(n-20,e.y))),e.x<=20&&(e.y<n/2-y/2||e.y>n/2+y/2?(e.vx*=-.7,e.x=20):e.x<=0&&(g(t=>{const o={...t,redScore:t.redScore+1};return l.current=o,o}),Y(),E(),L())),e.x>=i-20&&(e.y<n/2-y/2||e.y>n/2+y/2?(e.vx*=-.7,e.x=i-20):e.x>=i&&(g(t=>{const o={...t,blueScore:t.blueScore+1};return l.current=o,o}),Y(),E(),L())),Math.abs(e.vx)<.2&&(e.vx=0),Math.abs(e.vy)<.2&&(e.vy=0)},Y=()=>{b.current.x=i/2,b.current.y=n/2,b.current.vx=0,b.current.vy=0},$=()=>{const e=b.current;w.current.forEach(t=>{if(p(t.x,t.y,e.x,e.y)<j+X){const a=Math.atan2(e.y-t.y,e.x-t.x);let r,c=a;if(t.isControlledByUser)r=8;else{const u=t.team==="blue",x=u?i-30:30,f=n/2;switch(t.position){case"GK":c=Math.abs(e.y-n/2)>100?Math.atan2(n/2-e.y,u?-200:200):Math.atan2(e.y<n/2?-150:150,u?-100:100),r=7;break;case"DEF":Math.random()>.3?c=Math.atan2(0,u?200:-200):c=Math.atan2(Math.random()>.5?-100:100,u?150:-150),r=6;break;case"MID":const S=w.current.filter(m=>m.team===t.team&&m.id!==t.id&&m.position!=="GK").sort((m,F)=>p(m.x,m.y,e.x,e.y)-p(F.x,F.y,e.x,e.y))[0];S&&Math.random()>.4?(c=Math.atan2(S.y-e.y,S.x-e.x),r=5):(c=Math.atan2(f-e.y,x-e.x),r=6);break;case"ATT":p(e.x,e.y,x,f)<200&&Math.random()>.2?(c=Math.atan2(f-e.y+(Math.random()-.5)*40,x-e.x),r=9):(c=Math.atan2(f-e.y,x-e.x),r=7);break;default:r=6}}e.vx=Math.cos(c)*r,e.vy=Math.sin(c)*r,e.x=t.x+Math.cos(a)*(j+X+2),e.y=t.y+Math.sin(a)*(j+X+2)}})},Q=()=>{const e=w.current.find(o=>o.isControlledByUser);if(!e)return;const t=e.speed;(M.current.w||M.current.arrowup)&&(e.y-=t),(M.current.s||M.current.arrowdown)&&(e.y+=t),(M.current.a||M.current.arrowleft)&&(e.x-=t),(M.current.d||M.current.arrowright)&&(e.x+=t),e.x=Math.max(20,Math.min(i-20,e.x)),e.y=Math.max(20,Math.min(n-20,e.y))},R=h.useCallback(()=>{const e=D.current;if(!e)return;const t=e.getContext("2d");t&&(t.clearRect(0,0,i,n),W(t),w.current.forEach(o=>{K(t,o)}),U(t,b.current),l.current.gameStarted&&l.current.timeLeft>0&&!l.current.isCountdown&&(Q(),_(),J(),$()),l.current.isCountdown&&l.current.countdownValue>0&&(t.fillStyle="rgba(0, 0, 0, 0.7)",t.fillRect(0,0,i,n),l.current.showGoal&&(t.fillStyle="#FFD700",t.font="bold 80px Arial",t.textAlign="center",t.fillText("Â¡GOL!",i/2,n/2-50)),t.fillStyle="#FFFFFF",t.font="bold 120px Arial",t.textAlign="center",t.fillText(l.current.countdownValue.toString(),i/2,n/2+40)),l.current.timeLeft>0&&(I.current=requestAnimationFrame(R)))},[]),ee=()=>{console.log("Starting game..."),P(!1),z(),console.log("Players initialized:",w.current.length),Y();const e={gameStarted:!0,currentHalf:1,timeLeft:300,blueScore:0,redScore:0,isCountdown:!0,countdownValue:3,showGoal:!1};g(e),l.current=e,console.log("Starting initial countdown"),setTimeout(()=>{k(()=>{console.log("Countdown finished, game ready");const t={...l.current,isCountdown:!1};g(t),l.current=t})},100),setTimeout(()=>{R()},50)};return h.useEffect(()=>{const e=o=>{M.current[o.key.toLowerCase()]=!0},t=o=>{M.current[o.key.toLowerCase()]=!1};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t),I.current&&cancelAnimationFrame(I.current)}},[]),B?s.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #2e7d32 0%, #4caf50 50%, #66bb6a 100%)",display:"flex",justifyContent:"center",alignItems:"center",fontFamily:"Arial, sans-serif",padding:"20px"},children:s.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.95)",borderRadius:"20px",padding:"40px",maxWidth:"600px",textAlign:"center",boxShadow:"0 20px 40px rgba(0,0,0,0.3)"},children:[s.jsx("h1",{style:{fontSize:"2.5rem",color:"#2e7d32",marginBottom:"30px",textShadow:"2px 2px 4px rgba(0,0,0,0.1)"},children:"âš½ FÃšTBOL"}),s.jsxs("div",{style:{textAlign:"left",marginBottom:"30px",fontSize:"1.1rem",lineHeight:"1.6"},children:[s.jsx("h3",{style:{color:"#1976d2",marginBottom:"15px"},children:"ðŸŽ® CONTROLES:"}),s.jsxs("p",{children:[s.jsx("strong",{children:"WASD"})," o ",s.jsx("strong",{children:"Flechas"})," - Mover jugador"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Objetivo:"})," Controla a tu jugador y ayuda a tu equipo a marcar goles"]}),s.jsx("h3",{style:{color:"#1976d2",marginTop:"25px",marginBottom:"15px"},children:"âš½ REGLAS:"}),s.jsx("p",{children:"â€¢ AcÃ©rcate a la pelota para tocarla y patearla"}),s.jsx("p",{children:"â€¢ Tu jugador tiene borde amarillo"}),s.jsx("p",{children:"â€¢ El equipo azul ataca hacia la derecha"}),s.jsx("p",{children:"â€¢ Los demÃ¡s jugadores son controlados por IA"})]}),s.jsxs("div",{style:{marginBottom:"30px",padding:"20px",background:"#f5f5f5",borderRadius:"10px"},children:[s.jsx("h3",{style:{color:"#1976d2",marginBottom:"15px"},children:"ðŸ‘¤ SELECCIONA TU JUGADOR:"}),s.jsxs("div",{style:{marginBottom:"20px"},children:[s.jsx("label",{style:{display:"block",marginBottom:"10px",fontWeight:"bold"},children:"Jugador del Equipo Azul:"}),s.jsxs("select",{value:A,onChange:e=>O(Number(e.target.value)),style:{padding:"8px 15px",fontSize:"16px",borderRadius:"5px",border:"2px solid #ddd",width:"100%"},children:[s.jsx("option",{value:0,children:"Portero (GK)"}),s.jsx("option",{value:1,children:"Defensa 1 (DEF)"}),s.jsx("option",{value:2,children:"Defensa 2 (DEF)"}),s.jsx("option",{value:3,children:"Medio 1 (MID)"}),s.jsx("option",{value:4,children:"Medio 2 (MID)"}),s.jsx("option",{value:5,children:"Delantero (ATT)"})]})]})]}),s.jsx("button",{onClick:ee,style:{fontSize:"1.3rem",padding:"15px 40px",background:"linear-gradient(145deg, #4caf50, #45a049)",color:"white",border:"none",borderRadius:"25px",cursor:"pointer",fontWeight:"bold",boxShadow:"0 8px 20px rgba(76, 175, 80, 0.4)",transition:"all 0.3s ease"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 12px 25px rgba(76, 175, 80, 0.5)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 8px 20px rgba(76, 175, 80, 0.4)"},children:"ðŸš€ Â¡COMENZAR PARTIDO!"})]})}):s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",minHeight:"100vh",background:"linear-gradient(135deg, #2e7d32 0%, #4caf50 100%)",padding:"20px"},children:[s.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.9)",padding:"15px 30px",borderRadius:"15px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"30px",fontSize:"1.1rem",fontWeight:"bold",boxShadow:"0 5px 15px rgba(0,0,0,0.2)"},children:[s.jsxs("div",{style:{color:"#0066FF"},children:["AZUL: ",d.blueScore]}),s.jsxs("div",{style:{color:"#333",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"1.2rem"},children:"FÃšTBOL âš½"}),s.jsx("div",{style:{fontSize:"0.9rem",marginTop:"5px"},children:d.timeLeft>0?s.jsxs(s.Fragment,{children:[d.currentHalf,"Â° TIEMPO - ",H(d.timeLeft)]}):"PARTIDO TERMINADO"})]}),s.jsxs("div",{style:{color:"#FF0000"},children:["ROJO: ",d.redScore]})]}),s.jsx("canvas",{ref:D,width:i,height:n,style:{border:"4px solid #fff",borderRadius:"10px",boxShadow:"0 10px 30px rgba(0,0,0,0.3)",background:"#228B22"}}),s.jsxs("div",{style:{marginTop:"20px",background:"rgba(255, 255, 255, 0.9)",padding:"15px",borderRadius:"10px",textAlign:"center",maxWidth:"600px"},children:[s.jsxs("p",{style:{margin:"5px 0",color:"#333"},children:[s.jsx("strong",{children:"Controles:"})," WASD o Flechas para mover"]}),s.jsx("p",{style:{margin:"5px 0",color:"#666",fontSize:"0.9rem"},children:"Tu jugador tiene un borde amarillo. AcÃ©rcate a la pelota para patearla."})]})]})};export{re as default};
