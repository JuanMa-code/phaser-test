import{r as F,A as S,j as M,G as y,T as k}from"./index-CSoRfwyt.js";const a=13,l=12,i=40,g=[{type:"road",speed:2,dir:1,count:3},{type:"road",speed:3,dir:-1,count:2},{type:"road",speed:2,dir:1,count:2},{type:"water",speed:2,dir:-1,count:2},{type:"water",speed:3,dir:1,count:3},{type:"water",speed:2,dir:-1,count:2}],O=()=>{const m=F.useRef(null),A=F.useRef(null);return F.useEffect(()=>{const s=new S({width:a*i,height:l*i,backgroundColor:2236962});A.current=s,m.current&&s.view instanceof Node&&m.current.appendChild(s.view);let o={x:Math.floor(a/2),y:l-1},w=[],p=[],h=!1,u=!1;function b(){o={x:Math.floor(a/2),y:l-1},w=[],p=[],h=!1,u=!1;for(let t=0;t<g.length;t++){const n=g[t];for(let e=0;e<n.count;e++){const r=Math.floor(Math.random()*a);n.type==="road"?p.push({x:r,y:t+2,lane:t}):w.push({x:r,y:t+2,lane:t})}}x()}function x(){s.stage.removeChildren();for(let n=0;n<l;n++){const e=new y;if(n===0)e.beginFill(43520);else if(n===l-1)e.beginFill(26112);else if(n>=2&&n<2+g.length){const r=g[n-2];e.beginFill(r.type==="road"?4473924:3381759)}else e.beginFill(2236962);e.drawRect(0,0,a*i,i),e.endFill(),e.y=n*i,s.stage.addChild(e)}w.forEach(n=>{const e=new y;e.beginFill(10053171),e.drawRect(0,0,i*2,i-8),e.endFill(),e.x=n.x*i,e.y=n.y*i+4,s.stage.addChild(e)}),p.forEach(n=>{const e=new y;e.beginFill(16724787),e.drawRect(0,0,i-4,i-8),e.endFill(),e.x=n.x*i+2,e.y=n.y*i+4,s.stage.addChild(e)});const t=new y;if(t.beginFill(65280),t.drawCircle(i/2,i/2,i/2.2),t.endFill(),t.x=o.x*i,t.y=o.y*i,s.stage.addChild(t),h){const n="Game Over! Pulsa espacio para reiniciar",e=new k(n,{fill:"#ff0000",fontSize:24}),r=e.width,d=e.height,c=16,f=new y;f.beginFill(16777215,.85),f.drawRect((a*i-r)/2-c,(l*i-d)/2-c,r+c*2,d+c*2),f.endFill(),s.stage.addChild(f),e.x=(a*i-r)/2,e.y=(l*i-d)/2,s.stage.addChild(e)}if(u){const n="Â¡Has ganado! Pulsa espacio para reiniciar",e=new k(n,{fill:43520,fontSize:24}),r=e.width,d=e.height,c=16,f=new y;f.beginFill(16777215,.85),f.drawRect((a*i-r)/2-c,(l*i-d)/2-c,r+c*2,d+c*2),f.endFill(),s.stage.addChild(f),e.x=(a*i-r)/2,e.y=(l*i-d)/2,s.stage.addChild(e)}}function L(){w.forEach(t=>{const n=g[t.lane];t.x+=n.speed*n.dir*.04,t.x<-2&&(t.x=a),t.x>a&&(t.x=-2)}),p.forEach(t=>{const n=g[t.lane];t.x+=n.speed*n.dir*.04,t.x<-1&&(t.x=a),t.x>a&&(t.x=-1)})}function C(){if(p.some(n=>Math.round(n.x)===o.x&&n.y===o.y)){h=!0,x();return}const t=o.y-2;if(t>=0&&t<g.length&&g[t].type==="water"){let n=!1;for(const e of w){const r=Math.floor(e.x),d=r+1;if(e.y===o.y&&o.x>=r&&o.x<=d){n=!0;break}}if(!n){h=!0,x();return}}if(o.y===0){u=!0,x();return}}function E(t){if((h||u)&&t.code==="Space"){b();return}h||u||(t.key==="ArrowUp"&&o.y>0&&o.y--,t.key==="ArrowDown"&&o.y<l-1&&o.y++,t.key==="ArrowLeft"&&o.x>0&&o.x--,t.key==="ArrowRight"&&o.x<a-1&&o.x++,C(),x())}let R;function v(){!h&&!u&&(L(),C(),x()),R=requestAnimationFrame(v)}return window.addEventListener("keydown",E),b(),v(),()=>{window.removeEventListener("keydown",E),cancelAnimationFrame(R),s.destroy(!0,{children:!0})}},[]),M.jsx("div",{ref:m,style:{width:a*i,height:l*i+48,margin:"auto"}})};export{O as default};
