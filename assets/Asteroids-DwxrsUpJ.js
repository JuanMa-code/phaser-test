import{r as n,j as h}from"./index-DT6De0vj.js";import{P as m}from"./phaser-CtSIbetW.js";import{G as M,a as w}from"./GameOverScreen-DSWsITTW.js";const u=800,y=600,a=15,G=40,E=25,D=15,T=400,P=300,I=.99,x=200,C=200;class R extends m.Scene{ship;shipGraphics;asteroids;bullets;cursors;wasd;spaceKey;score=0;lives=3;level=1;invulnerable=!1;invulnerableTime=0;onScoreUpdate;onLivesUpdate;onLevelUpdate;onGameOver;constructor(s,t,e,r){super("AsteroidsScene"),this.onScoreUpdate=s,this.onLivesUpdate=t,this.onLevelUpdate=e,this.onGameOver=r}create(){this.cameras.main.setBackgroundColor("#000011");const s=this.add.graphics();s.fillStyle(16777215);for(let t=0;t<150;t++)s.fillCircle(Math.random()*u,Math.random()*y,Math.random()*1.5);this.asteroids=this.physics.add.group(),this.bullets=this.physics.add.group(),this.createShip(),this.input.keyboard&&(this.cursors=this.input.keyboard.createCursorKeys(),this.wasd=this.input.keyboard.addKeys("W,A,D"),this.spaceKey=this.input.keyboard.addKey(m.Input.Keyboard.KeyCodes.SPACE)),this.input.keyboard?.on("keydown-SPACE",this.fireBullet,this),this.createInitialAsteroids(),this.physics.add.overlap(this.bullets,this.asteroids,this.bulletHitAsteroid,void 0,this),this.physics.add.overlap(this.ship,this.asteroids,this.shipHitAsteroid,void 0,this)}update(s,t){this.handleShipMovement(t),this.physics.world.wrap(this.ship,a),this.physics.world.wrap(this.asteroids,G),this.physics.world.wrap(this.bullets,0),this.bullets.getChildren().forEach(e=>{e.lifespan-=t,e.lifespan<=0&&e.destroy()}),this.invulnerable&&(this.invulnerableTime-=t,this.invulnerableTime<=0?(this.invulnerable=!1,this.ship.alpha=1):this.ship.alpha=.5+Math.sin(s/50)*.5),this.asteroids.countActive()===0&&(this.level++,this.onLevelUpdate(this.level),this.createInitialAsteroids())}createShip(){this.ship=this.add.container(u/2,y/2),this.shipGraphics=this.add.graphics(),this.drawShipGraphics(!1),this.ship.add(this.shipGraphics),this.physics.add.existing(this.ship);const s=this.ship.body;s.setDrag(I),s.setMaxVelocity(P),s.setCircle(a,-a,-a)}drawShipGraphics(s){this.shipGraphics.clear();const t=65535;this.shipGraphics.lineStyle(2,t),this.shipGraphics.fillStyle(t,.3),this.shipGraphics.beginPath(),this.shipGraphics.moveTo(0,-a),this.shipGraphics.lineTo(a,a),this.shipGraphics.lineTo(0,a*.5),this.shipGraphics.lineTo(-a,a),this.shipGraphics.closePath(),this.shipGraphics.strokePath(),this.shipGraphics.fillPath(),s&&(this.shipGraphics.lineStyle(2,16729088),this.shipGraphics.fillStyle(16729088,.7),this.shipGraphics.beginPath(),this.shipGraphics.moveTo(-a*.5,a),this.shipGraphics.lineTo(0,a*1.8+Math.random()*5),this.shipGraphics.lineTo(a*.5,a),this.shipGraphics.closePath(),this.shipGraphics.strokePath(),this.shipGraphics.fillPath())}handleShipMovement(s){const t=this.ship.body;let e=!1;this.cursors.left.isDown||this.wasd.A.isDown?t.setAngularVelocity(-x):this.cursors.right.isDown||this.wasd.D.isDown?t.setAngularVelocity(x):t.setAngularVelocity(0),this.cursors.up.isDown||this.wasd.W.isDown?(this.physics.velocityFromRotation(this.ship.rotation-Math.PI/2,C,t.acceleration),e=!0):t.setAcceleration(0),this.drawShipGraphics(e)}fireBullet(){if(!this.ship.active||this.bullets.countActive()>=4)return;const s=this.add.circle(this.ship.x,this.ship.y,2,16776960);this.physics.add.existing(s);const t=s.body,e=this.ship.rotation-Math.PI/2,r=this.physics.velocityFromRotation(e,T);s.setPosition(this.ship.x+Math.cos(e)*a,this.ship.y+Math.sin(e)*a),t.setVelocity(r.x,r.y),s.lifespan=2e3,this.bullets.add(s)}createInitialAsteroids(){const s=4+this.level*2;for(let t=0;t<s;t++){let e,r;do e=Math.random()*u,r=Math.random()*y;while(m.Math.Distance.Between(e,r,this.ship.x,this.ship.y)<150);this.createAsteroid(e,r,"large")}}createAsteroid(s,t,e){const r=e==="large"?G:e==="medium"?E:D,i=this.add.graphics(),o=8+Math.floor(Math.random()*4),l=[11184810,8947848,6710886],b=l[Math.floor(Math.random()*l.length)];i.fillStyle(b),i.lineStyle(1,13421772),i.beginPath();for(let p=0;p<o;p++){const f=p/o*Math.PI*2,v=r*(.8+Math.random()*.4),g=Math.cos(f)*v,S=Math.sin(f)*v;p===0?i.moveTo(g,S):i.lineTo(g,S)}i.closePath(),i.fillPath(),i.strokePath(),i.x=s,i.y=t,this.physics.add.existing(i);const d=i.body;d.setCircle(r),d.setVelocity((Math.random()-.5)*100,(Math.random()-.5)*100),i.setData("size",e),this.asteroids.add(i)}bulletHitAsteroid(s,t){s.destroy();const e=t.getData("size"),r=t.x,i=t.y;t.destroy();let o=0;e==="large"?(o=20,this.createAsteroid(r,i,"medium"),this.createAsteroid(r,i,"medium")):e==="medium"?(o=50,this.createAsteroid(r,i,"small"),this.createAsteroid(r,i,"small")):o=100,this.score+=o,this.onScoreUpdate(this.score)}shipHitAsteroid(s,t){this.invulnerable||(this.lives--,this.onLivesUpdate(this.lives),this.lives<=0?(this.scene.pause(),this.onGameOver(this.score)):this.respawnShip())}respawnShip(){this.ship.setPosition(u/2,y/2);const s=this.ship.body;s.setVelocity(0,0),s.setAcceleration(0),s.setAngularVelocity(0),this.ship.rotation=0,this.invulnerable=!0,this.invulnerableTime=3e3}}const k=()=>{const A=n.useRef(null),s=n.useRef(null),[t,e]=n.useState(!1),[r,i]=n.useState(!1),[o,l]=n.useState(0),[b,d]=n.useState(3),[p,f]=n.useState(1);n.useEffect(()=>{if(!t||r)return;const S={type:m.AUTO,width:u,height:y,parent:A.current||void 0,backgroundColor:"#000011",physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}},scene:new R(c=>l(c),c=>d(c),c=>f(c),c=>{l(c),i(!0)})};return s.current=new m.Game(S),()=>{s.current&&(s.current.destroy(!0),s.current=null)}},[t,r]);const v=()=>{e(!0),i(!1),l(0),d(3),f(1)},g=()=>{i(!1),l(0),d(3),f(1)};return t?r?h.jsx(w,{score:o,onRestart:g,onMenu:()=>e(!1),theme:{background:"linear-gradient(135deg, #110000 0%, #220011 100%)",primaryColor:"#00ffff",secondaryColor:"#ffff00",accentColor:"#ff0080",titleGradient:"linear-gradient(45deg, #ffffff, #00ffff, #ffff00, #ff0080)",buttonGradient:"linear-gradient(45deg, #00ffff, #ffff00)"}}):h.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",background:"linear-gradient(135deg, #000011 0%, #001122 100%)",minHeight:"100dvh",fontFamily:"Arial, sans-serif",color:"white"},children:[h.jsx("h1",{style:{margin:"0 0 20px 0",fontSize:"2.5rem"},children:"üöÄ ASTEROIDS"}),h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:u,marginBottom:"10px",fontSize:"24px"},children:[h.jsxs("div",{children:["Score: ",o]}),h.jsxs("div",{style:{color:"#00ff00"},children:["Level: ",p]}),h.jsxs("div",{style:{color:"#ff0000"},children:["Lives: ",b]})]}),h.jsx("div",{ref:A,style:{border:"2px solid #444",borderRadius:"10px"}}),h.jsx("div",{style:{marginTop:"20px",fontSize:"1.2rem"},children:h.jsx("p",{children:"‚Üê ‚Üí A D rotar, ‚Üë W acelerar, Espacio disparar"})})]}):h.jsx(M,{title:"üöÄ ASTEROIDS",description:"¬°Navega por el espacio y destruye asteroides!",instructions:[{title:"Controles",items:["‚Üê ‚Üí A D: Rotar nave","‚Üë W: Acelerar","Espacio: Disparar"],icon:"üéÆ"},{title:"Caracter√≠sticas",items:["Inercia y gravedad cero","Teletransporte en bordes","3 segundos invulnerable"],icon:"‚≠ê"}],onStart:v,theme:{background:"linear-gradient(135deg, #000011 0%, #001122 100%)",primary:"#00ffff",secondary:"#ffff00",accent:"#ff0080"}})};export{k as default};
