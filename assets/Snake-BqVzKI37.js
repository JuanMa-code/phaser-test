import{r as f,j as n}from"./index-DT6De0vj.js";import{P as a}from"./phaser-CtSIbetW.js";import{G as m,a as p}from"./GameOverScreen-DSWsITTW.js";const d=20,l=15,e=32,y=150;class k extends a.Scene{snake=[];food;direction="RIGHT";nextDirection="RIGHT";moveTimer=0;score=0;isGameOver=!1;cursors;wasd;onScoreUpdate;onGameOver;constructor(s,i){super("SnakeScene"),this.onScoreUpdate=s,this.onGameOver=i}preload(){const s=this.make.graphics({x:0,y:0});s.fillStyle(16729943),s.fillCircle(e/2,e/2,e/2.5),s.fillStyle(65280),s.fillRect(e/2-2,e/4,4,8),s.generateTexture("food",e,e)}create(){const s=this.add.graphics();s.lineStyle(1,3355443,.3);for(let t=0;t<=d;t++)s.moveTo(t*e,0),s.lineTo(t*e,l*e);for(let t=0;t<=l;t++)s.moveTo(0,t*e),s.lineTo(d*e,t*e);s.strokePath(),this.createSnake(),this.food=this.add.container(0,0);const i=this.add.sprite(e/2,e/2,"food");this.food.add(i),this.placeFood(),this.cursors=this.input.keyboard.createCursorKeys(),this.wasd={up:this.input.keyboard.addKey(a.Input.Keyboard.KeyCodes.W),down:this.input.keyboard.addKey(a.Input.Keyboard.KeyCodes.S),left:this.input.keyboard.addKey(a.Input.Keyboard.KeyCodes.A),right:this.input.keyboard.addKey(a.Input.Keyboard.KeyCodes.D)}}createSnake(){this.snake.forEach(t=>t.destroy()),this.snake=[];const s=5,i=7;for(let t=0;t<3;t++)this.addSnakePart(s-t,i);this.direction="RIGHT",this.nextDirection="RIGHT"}addSnakePart(s,i){const o=this.snake.length===0?65280:39168,r=this.add.rectangle(s*e+e/2,i*e+e/2,e-4,e-4,o);this.snake.push(r)}placeFood(){let s=!1,i=0,t=0;for(;!s;)i=a.Math.Between(0,d-1),t=a.Math.Between(0,l-1),s=!this.snake.some(o=>{const r=Math.floor(o.x/e),h=Math.floor(o.y/e);return r===i&&h===t});this.food.setPosition(i*e,t*e)}update(s,i){this.isGameOver||(this.handleInput(),this.moveTimer+=i,this.moveTimer>y&&(this.moveTimer=0,this.moveSnake()))}handleInput(){(this.cursors.up.isDown||this.wasd.up.isDown)&&this.direction!=="DOWN"?this.nextDirection="UP":(this.cursors.down.isDown||this.wasd.down.isDown)&&this.direction!=="UP"?this.nextDirection="DOWN":(this.cursors.left.isDown||this.wasd.left.isDown)&&this.direction!=="RIGHT"?this.nextDirection="LEFT":(this.cursors.right.isDown||this.wasd.right.isDown)&&this.direction!=="LEFT"&&(this.nextDirection="RIGHT")}moveSnake(){this.direction=this.nextDirection;const s=this.snake[0];let i=Math.floor(s.x/e),t=Math.floor(s.y/e);switch(this.direction){case"UP":t--;break;case"DOWN":t++;break;case"LEFT":i--;break;case"RIGHT":i++;break}if(this.checkCollision(i,t)){this.gameOver();return}const o=Math.floor(this.food.x/e),r=Math.floor(this.food.y/e);i===o&&t===r?(this.growSnake(i,t),this.placeFood(),this.score++,this.onScoreUpdate(this.score)):this.moveBody(i,t)}checkCollision(s,i){if(s<0||s>=d||i<0||i>=l)return!0;for(let t=0;t<this.snake.length-1;t++){const o=this.snake[t],r=Math.floor(o.x/e),h=Math.floor(o.y/e);if(r===s&&h===i)return!0}return!1}growSnake(s,i){const t=this.add.rectangle(s*e+e/2,i*e+e/2,e-4,e-4,65280);this.snake[0].setFillStyle(39168),this.snake.unshift(t)}moveBody(s,i){const t=this.snake.pop();t&&(t.setPosition(s*e+e/2,i*e+e/2),t.setFillStyle(65280),this.snake[0].setFillStyle(39168),this.snake.unshift(t))}gameOver(){this.isGameOver=!0,this.onGameOver(this.score)}}const x=()=>{const[c,s]=f.useState("start"),[i,t]=f.useState(0),o=f.useRef(null);f.useEffect(()=>{if(c==="playing"){const h={type:a.AUTO,width:d*e,height:l*e,parent:"phaser-game",backgroundColor:"#1a1a2e",scene:new k(u=>t(u),u=>{t(u),s("gameover")})};return o.current=new a.Game(h),()=>{o.current&&(o.current.destroy(!0),o.current=null)}}},[c]);const r=()=>{t(0),s("playing")};return c==="start"?n.jsx(m,{title:"üêç SNAKE",description:"¬°Come manzanas y haz crecer tu serpiente sin chocarte!",instructions:[{title:"Controles",items:["WASD: Mover en todas direcciones","‚Üë‚Üì‚Üê‚Üí: Tambi√©n puedes usar las flechas"],icon:"üéÆ"},{title:"Objetivo",items:["üçé Come las manzanas rojas para crecer","‚ö†Ô∏è No choques contra las paredes o tu cola"],icon:"üéØ"},{title:"Consejos",items:["Planifica tus movimientos","Mant√©n espacio libre","¬°La serpiente no puede ir hacia atr√°s!"],icon:"üí°"}],onStart:r,theme:{primary:"#00ff00",secondary:"#32ff7e",accent:"#32ff7e",background:"linear-gradient(135deg, #2d5016 0%, #0f3460 50%, #16213e 100%)"}}):c==="gameover"?n.jsx(p,{score:i,onRestart:r,onMenu:()=>s("start"),theme:{primary:"#00ff00",secondary:"#32ff7e",accent:"#32ff7e",background:"linear-gradient(135deg, #2d5016 0%, #0f3460 50%, #16213e 100%)"}}):n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",background:"#1a1a2e",minHeight:"100dvh",color:"white"},children:[n.jsx("h1",{style:{margin:"0 0 20px 0",color:"#00ff00"},children:"üêç Snake"}),n.jsxs("div",{style:{marginBottom:"1rem",fontSize:"1.5rem",fontWeight:"bold"},children:["Puntuaci√≥n: ",i]}),n.jsx("div",{id:"phaser-game",style:{border:"3px solid #00ff00",borderRadius:"8px",overflow:"hidden"}}),n.jsx("div",{style:{marginTop:"20px",color:"#666"},children:"Usa las flechas o WASD para moverte"})]})};export{x as default};
