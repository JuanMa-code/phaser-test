import{r as d,j as r}from"./index-DT6De0vj.js";import{P as p}from"./phaser-CtSIbetW.js";import{G as T,a as E}from"./GameOverScreen-DSWsITTW.js";const x=720,C=540,u=80,y=70;class M extends p.Scene{holes=[];moles=[];score=0;timeLeft=60;combo=0;settings;onScoreUpdate;onTimeUpdate;onComboUpdate;onGameOver;gameTimer;constructor(o,s,t,e,a){super("WhacAMoleScene"),this.settings=o,this.onScoreUpdate=s,this.onTimeUpdate=t,this.onComboUpdate=e,this.onGameOver=a}create(){this.createBackground(),this.createHoles(),this.gameTimer=this.time.addEvent({delay:1e3,callback:this.updateTimer,callbackScope:this,loop:!0})}createBackground(){const o=this.add.graphics();o.fillStyle(3046706),o.fillRect(0,0,x,C);for(let s=0;s<50;s++){const t=this.add.graphics();t.fillStyle(5025616,Math.random()*.3+.7),t.fillRect(0,0,15,8),t.x=Math.random()*x,t.y=Math.random()*C,t.rotation=Math.random()*Math.PI}}createHoles(){for(let m=0;m<3;m++)for(let n=0;n<3;n++){const S=120+n*180,h=100+m*140,f=this.add.container(S,h),l=this.add.graphics();l.fillStyle(3046706),l.fillEllipse(0,-5,u/2+5,u/3+3),l.fillStyle(1793568),l.fillEllipse(0,0,u/2,u/3),f.add(l),this.holes.push(f),this.moles.push(null)}}update(o,s){if(this.timeLeft<=0)return;if(this.moles.filter(e=>e!==null).length<this.settings.maxMoles&&Math.random()<this.settings.spawnRate){const e=this.moles.map((a,c)=>a===null?c:-1).filter(a=>a!==-1);if(e.length>0){const a=p.Utils.Array.GetRandom(e);this.spawnMole(a)}}}spawnMole(o){const s=this.holes[o],t=this.add.container(s.x,s.y),e=this.add.graphics();e.fillStyle(9268835),e.fillEllipse(0,0,y/2,y/2.5),e.fillStyle(7951688),e.fillEllipse(0,15,15,8),e.fillStyle(0),e.fillCircle(-12,-8,4),e.fillCircle(12,-8,4),e.fillStyle(16777215),e.fillCircle(-10,-10,1.5),e.fillCircle(14,-10,1.5),e.fillStyle(0),e.fillEllipse(0,12,3,2),e.fillStyle(7162945),e.fillEllipse(-18,-20,8,6),e.fillEllipse(18,-20,8,6),e.lineStyle(2,0),e.beginPath(),e.moveTo(-20,8),e.lineTo(-35,5),e.moveTo(-20,15),e.lineTo(-35,18),e.moveTo(20,8),e.lineTo(35,5),e.moveTo(20,15),e.lineTo(35,18),e.strokePath(),t.add(e);const a=new p.Geom.Ellipse(0,0,y,y*.8);t.setInteractive(a,p.Geom.Ellipse.Contains),t.on("pointerdown",()=>this.hitMole(o)),t.y+=50,t.alpha=0,this.tweens.add({targets:t,y:s.y,alpha:1,duration:200,ease:"Back.out"});const c=this.time.delayedCall(this.settings.moleShowTime*16,()=>{this.removeMole(o,!1)});t.setData("hideTimer",c),this.moles[o]=t}hitMole(o){const s=this.moles[o];if(!s)return;const t=s.getData("hideTimer");t&&t.remove(),this.combo++;const e=this.combo>5?15:this.combo>3?10:5;this.score+=e,this.onScoreUpdate(this.score),this.onComboUpdate(this.combo);const a=this.add.text(s.x,s.y-50,`+${e}`,{fontSize:"32px",color:this.combo>5?"#FFD700":this.combo>3?"#FF6347":"#4CAF50",fontStyle:"bold"}).setOrigin(.5);this.tweens.add({targets:a,y:a.y-50,alpha:0,duration:1e3,onComplete:()=>a.destroy()}),this.tweens.add({targets:s,scaleX:1.2,scaleY:.8,duration:50,yoyo:!0,onComplete:()=>{this.removeMole(o,!0)}})}removeMole(o,s){const t=this.moles[o];t&&(s||(this.combo=0,this.onComboUpdate(0)),this.moles[o]=null,this.tweens.add({targets:t,y:t.y+50,alpha:0,duration:200,ease:"Back.in",onComplete:()=>t.destroy()}))}updateTimer(){this.timeLeft--,this.onTimeUpdate(this.timeLeft),this.timeLeft<=0&&(this.gameTimer&&this.gameTimer.remove(),this.onGameOver(this.score),this.scene.pause())}}const D=()=>{const[g,o]=d.useState("start"),[s,t]=d.useState(0),[e,a]=d.useState(60),[c,m]=d.useState(0),[n,S]=d.useState("medium"),[h,f]=d.useState(()=>{const i=localStorage.getItem("whac-highscore");return i?parseInt(i):0}),l=d.useRef(null);d.useEffect(()=>{if(g==="playing"){const i={easy:{moleShowTime:120,spawnRate:.02,maxMoles:2},medium:{moleShowTime:90,spawnRate:.03,maxMoles:3},hard:{moleShowTime:60,spawnRate:.04,maxMoles:4}},w={type:p.AUTO,width:x,height:C,parent:"phaser-game",backgroundColor:"#2E7D32",scene:new M(i[n],t,a,m,b=>{b>h&&(f(b),localStorage.setItem("whac-highscore",b.toString())),o("gameOver")})};return l.current=new p.Game(w),()=>{l.current&&(l.current.destroy(!0),l.current=null)}}},[g,n]);const F=()=>{t(0),a(60),m(0),o("playing")};if(g==="start")return r.jsx(T,{title:"ðŸ”¨ WHAC-A-MOLE",description:"Â¡Golpea a los topos antes de que se escondan!",instructions:[{title:"Controles y PuntuaciÃ³n",items:["ðŸ–±ï¸ Click en los topos para golpearlos","âš¡ Sistema de combos: mÃ¡s hits seguidos = mÃ¡s puntos"],icon:"ðŸŽ®"},{title:"Consejos Pro",items:["â€¢ MantÃ©n la vista en todo el campo","â€¢ Los combos dan puntos extra","â€¢ Â¡Reacciona rÃ¡pido pero con precisiÃ³n!"],icon:"ðŸ’¡"}],highScore:h,onStart:F,theme:{background:"linear-gradient(135deg, #2E7D32 0%, #4CAF50 100%)",primary:"linear-gradient(45deg, #8D6E63, #A1887F)",secondary:"rgba(255, 255, 255, 0.2)",accent:"linear-gradient(45deg, #8D6E63, #D7CCC8)",text:"white"},children:r.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.1)",borderRadius:"15px",padding:"1.2rem",marginBottom:"1.5rem",border:"1px solid rgba(255, 255, 255, 0.2)"},children:[r.jsx("h3",{style:{fontSize:"1.2rem",marginBottom:"1rem",color:"#fff"},children:"ðŸŽ¯ Selecciona Dificultad"}),r.jsx("div",{style:{display:"flex",gap:"0.8rem",justifyContent:"center",flexWrap:"wrap"},children:["easy","medium","hard"].map(i=>r.jsxs("button",{onClick:()=>S(i),style:{padding:"0.6rem 1rem",fontSize:"0.9rem",background:n===i?"linear-gradient(45deg, #4CAF50, #45a049)":"rgba(255, 255, 255, 0.2)",border:n===i?"2px solid #4CAF50":"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"8px",color:"white",cursor:"pointer",fontWeight:"bold",transition:"all 0.3s ease",textAlign:"center"},children:[r.jsx("div",{children:i.charAt(0).toUpperCase()+i.slice(1)}),r.jsxs("div",{style:{fontSize:"0.7rem",opacity:.8},children:[i==="easy"&&"2 topos max",i==="medium"&&"3 topos max",i==="hard"&&"4 topos max"]})]},i))})]})});if(g==="gameOver"){const i=s===h&&s>0;return r.jsx(E,{score:s,highScore:h,isNewRecord:i,onRestart:F,onMenu:()=>o("start"),theme:{background:i?"linear-gradient(135deg, #FFD700 0%, #FFA500 100%)":"linear-gradient(135deg, #8D6E63 0%, #5D4037 100%)",primary:"linear-gradient(45deg, #8D6E63, #A1887F)",secondary:"#4CAF50",accent:i?"linear-gradient(45deg, #FFFFFF, #FFFF00)":"linear-gradient(45deg, #FFFFFF, #D7CCC8)"},customStats:[{label:"Dificultad",value:n.charAt(0).toUpperCase()+n.slice(1)},{label:"Mensaje",value:i?"Â¡IncreÃ­ble precisiÃ³n con el martillo!":"Los topos fueron mÃ¡s rÃ¡pidos..."}]})}return r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",background:"linear-gradient(135deg, #2E7D32 0%, #4CAF50 100%)",minHeight:"100dvh",fontFamily:"Arial, sans-serif",color:"white"},children:[r.jsx("h1",{style:{margin:"0 0 20px 0",fontSize:"2.5rem"},children:"ðŸ”¨ WHAC-A-MOLE"}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:x,marginBottom:"10px",fontSize:"1.5rem",fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.5)"},children:[r.jsxs("span",{children:["Score: ",s]}),r.jsxs("span",{style:{color:c>5?"#FFD700":c>3?"#FF6347":"#4CAF50",transition:"color 0.3s ease"},children:["Combo: ",c]}),r.jsxs("span",{children:["Time: ",e]})]}),r.jsx("div",{id:"phaser-game",style:{border:"3px solid #8D6E63",borderRadius:"10px",overflow:"hidden"}}),r.jsx("div",{style:{marginTop:"20px",fontSize:"1.2rem"},children:r.jsx("p",{children:"Â¡Click en los topos para golpearlos!"})})]})};export{D as default};
