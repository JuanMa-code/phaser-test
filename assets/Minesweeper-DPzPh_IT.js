import{r as h,j as a}from"./index-DT6De0vj.js";import{P as g}from"./phaser-CtSIbetW.js";import{G as v,a as y}from"./GameOverScreen-DSWsITTW.js";const i=35,f={beginner:{cols:9,rows:9,mines:10},intermediate:{cols:16,rows:16,mines:40},expert:{cols:30,rows:16,mines:99}};class S extends g.Scene{difficulty;config;board=[];cellSprites=[];firstClick=!0;minesLeft;isGameOver=!1;onMineCountUpdate;onGameOver;constructor(t,e,s){super("MinesweeperScene"),this.difficulty=t,this.config=f[t],this.minesLeft=this.config.mines,this.onMineCountUpdate=e,this.onGameOver=s}preload(){this.createTextures()}createTextures(){const t=this.make.graphics({x:0,y:0});t.fillStyle(12566463),t.fillRect(0,0,i,i),t.fillStyle(16777215),t.fillTriangle(0,0,i,0,0,i),t.fillStyle(8421504),t.fillTriangle(i,i,i,0,0,i),t.fillStyle(12566463),t.fillRect(4,4,i-8,i-8),t.generateTexture("cell-hidden",i,i);const e=this.make.graphics({x:0,y:0});e.fillStyle(12632256),e.fillRect(0,0,i,i),e.lineStyle(1,8421504),e.strokeRect(0,0,i,i),e.generateTexture("cell-revealed",i,i);const s=this.make.graphics({x:0,y:0});s.fillStyle(16711680),s.fillTriangle(i/2,5,i/2,20,i-5,12.5),s.lineStyle(2,0),s.moveTo(i/2,5),s.lineTo(i/2,30),s.strokePath(),s.generateTexture("flag",i,i);const n=this.make.graphics({x:0,y:0});n.fillStyle(0),n.fillCircle(i/2,i/2,i/3),n.lineStyle(2,0),n.moveTo(i/2,5),n.lineTo(i/2,i-5),n.moveTo(5,i/2),n.lineTo(i-5,i/2),n.moveTo(10,10),n.lineTo(i-10,i-10),n.moveTo(i-10,10),n.lineTo(10,i-10),n.strokePath(),n.generateTexture("mine",i,i)}create(){this.input.mouse.disableContextMenu(),this.initBoard(),this.createGrid()}initBoard(){this.board=[];for(let t=0;t<this.config.rows;t++){this.board[t]=[];for(let e=0;e<this.config.cols;e++)this.board[t][e]={x:e,y:t,mine:!1,revealed:!1,flagged:!1,adjacent:0}}}createGrid(){this.cellSprites=[];for(let t=0;t<this.config.rows;t++){this.cellSprites[t]=[];for(let e=0;e<this.config.cols;e++){const s=this.add.container(e*i,t*i),n=this.add.sprite(i/2,i/2,"cell-hidden");s.add(n);const r=this.add.zone(i/2,i/2,i,i);r.setInteractive(),r.on("pointerdown",l=>{this.handleInput(e,t,l)}),s.add(r),this.cellSprites[t][e]=s}}}handleInput(t,e,s){this.isGameOver||(s.rightButtonDown()?this.toggleFlag(t,e):s.leftButtonDown()&&(this.firstClick&&(this.placeMines(t,e),this.calculateAdjacent(),this.firstClick=!1),this.revealCell(t,e)))}placeMines(t,e){let s=0;for(;s<this.config.mines;){const n=g.Math.Between(0,this.config.cols-1),r=g.Math.Between(0,this.config.rows-1);!this.board[r][n].mine&&!(Math.abs(n-t)<=1&&Math.abs(r-e)<=1)&&(this.board[r][n].mine=!0,s++)}}calculateAdjacent(){for(let t=0;t<this.config.rows;t++)for(let e=0;e<this.config.cols;e++){if(this.board[t][e].mine)continue;let s=0;for(let n=-1;n<=1;n++)for(let r=-1;r<=1;r++){if(r===0&&n===0)continue;const l=e+r,d=t+n;l>=0&&l<this.config.cols&&d>=0&&d<this.config.rows&&this.board[d][l].mine&&s++}this.board[t][e].adjacent=s}}toggleFlag(t,e){const s=this.board[e][t];if(s.revealed)return;s.flagged=!s.flagged;const n=this.cellSprites[e][t];if(s.flagged){const r=this.add.sprite(i/2,i/2,"flag");r.setName("flag"),n.add(r),this.minesLeft--}else{const r=n.getByName("flag");r&&r.destroy(),this.minesLeft++}this.onMineCountUpdate(this.minesLeft)}revealCell(t,e){if(t<0||t>=this.config.cols||e<0||e>=this.config.rows)return;const s=this.board[e][t];if(!(s.revealed||s.flagged)){if(s.revealed=!0,this.updateCellVisuals(t,e),s.mine){this.gameOver(!1);return}if(s.adjacent===0)for(let n=-1;n<=1;n++)for(let r=-1;r<=1;r++)this.revealCell(t+r,e+n);this.checkWin()}}updateCellVisuals(t,e){const s=this.board[e][t],n=this.cellSprites[e][t];n.removeAll(!0);const r=this.add.sprite(i/2,i/2,"cell-revealed");if(n.add(r),s.mine){const l=this.add.sprite(i/2,i/2,"mine");n.add(l),r.setTint(16711680)}else if(s.adjacent>0){const l=["#0000ff","#008000","#ff0000","#000080","#800000","#008080","#000000","#808080"],d=this.add.text(i/2,i/2,s.adjacent.toString(),{fontSize:"20px",fontFamily:"Arial",fontStyle:"bold",color:l[s.adjacent-1]}).setOrigin(.5);n.add(d)}}gameOver(t){this.isGameOver=!0,t||this.revealAllMines(),this.onGameOver(t)}revealAllMines(){for(let t=0;t<this.config.rows;t++)for(let e=0;e<this.config.cols;e++)this.board[t][e].mine&&(this.board[t][e].revealed=!0,this.updateCellVisuals(e,t))}checkWin(){let t=0;for(let e=0;e<this.config.rows;e++)for(let s=0;s<this.config.cols;s++)this.board[e][s].revealed&&!this.board[e][s].mine&&t++;t===this.config.cols*this.config.rows-this.config.mines&&this.gameOver(!0)}}const T=()=>{const[o,t]=h.useState("beginner"),[e,s]=h.useState("start"),[n,r]=h.useState(f.beginner.mines),[l,d]=h.useState(0),m=h.useRef(null);h.useEffect(()=>{let c;return e==="playing"&&(c=setInterval(()=>{d(u=>u+1)},1e3)),()=>clearInterval(c)},[e]),h.useEffect(()=>{if(e==="playing"){const c=f[o],u={type:g.AUTO,width:c.cols*i,height:c.rows*i,parent:"phaser-game",backgroundColor:"#c0c0c0",scene:new S(o,p=>r(p),p=>s(p?"won":"lost"))};return m.current=new g.Game(u),()=>{m.current&&(m.current.destroy(!0),m.current=null)}}},[e,o]);const b=()=>{s("playing"),r(f[o].mines),d(0)},x=()=>{s("playing"),r(f[o].mines),d(0)};return e==="start"?a.jsx(v,{title:"üí£ Minesweeper",description:"¬°Encuentra todas las minas sin explotar ninguna!",instructions:[{title:"Controles",items:["üñ±Ô∏è Click izquierdo: Revelar casilla","üö© Click derecho: Marcar con bandera","üí° Los n√∫meros indican minas adyacentes","üéØ Encuentra todas las minas sin explotar ninguna"],icon:"üéÆ"},{title:"Caracter√≠sticas",items:["3 niveles de dificultad: Principiante, Intermedio, Experto","Temporizador integrado","Contador de minas","Efectos visuales cl√°sicos"],icon:"‚≠ê"}],onStart:b,theme:{background:"linear-gradient(135deg, #c0c0c0 0%, #808080 100%)",primary:"linear-gradient(45deg, #ff0000, #ff6600)",secondary:"rgba(255, 255, 255, 0.2)",accent:"linear-gradient(45deg, #ff0000, #0000ff, #008000)"},children:a.jsxs("div",{style:{marginBottom:"1.5rem"},children:[a.jsx("h3",{style:{color:"white",marginBottom:"0.5rem",fontSize:"1.1rem"},children:"Dificultad:"}),a.jsx("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center",flexWrap:"wrap"},children:Object.entries(f).map(([c,u])=>a.jsx("button",{onClick:()=>t(c),style:{padding:"0.5rem 1rem",fontSize:"0.9rem",background:o===c?"linear-gradient(45deg, #4CAF50, #45a049)":"rgba(255, 255, 255, 0.2)",border:o===c?"2px solid #4CAF50":"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"8px",color:"white",cursor:"pointer",fontWeight:"bold",transition:"all 0.3s ease"},children:c.charAt(0).toUpperCase()+c.slice(1)},c))})]})}):e==="won"||e==="lost"?a.jsx(y,{score:l,isVictory:e==="won",onRestart:x,onMenu:()=>s("start"),theme:{background:e==="won"?"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)":"linear-gradient(135deg, #f44336 0%, #d32f2f 100%)",primary:e==="won"?"linear-gradient(45deg, #4CAF50, #45a049)":"linear-gradient(45deg, #f44336, #d32f2f)",secondary:"rgba(255, 255, 255, 0.2)",accent:"linear-gradient(45deg, #ffffff, #e0e0e0)"},customStats:[{label:"Tiempo",value:`${l} segundos`},{label:"Dificultad",value:o.charAt(0).toUpperCase()+o.slice(1)},{label:"Minas",value:f[o].mines}]}):a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",background:"linear-gradient(135deg, #c0c0c0 0%, #808080 100%)",minHeight:"100dvh",fontFamily:"Arial, sans-serif",color:"black"},children:[a.jsx("h1",{style:{margin:"0 0 20px 0",fontSize:"2.5rem"},children:"üí£ MINESWEEPER"}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:f[o].cols*i,background:"#bfbfbf",padding:"10px",border:"3px solid #808080",borderBottom:"none",fontWeight:"bold",fontSize:"1.2rem"},children:[a.jsxs("span",{style:{color:"red"},children:["üí£ ",n]}),a.jsxs("span",{style:{color:"blue"},children:["‚è±Ô∏è ",l]})]}),a.jsx("div",{id:"phaser-game",style:{border:"3px solid #808080",borderRadius:"0 0 5px 5px"}}),a.jsx("div",{style:{marginTop:"20px",fontSize:"1rem"},children:a.jsx("p",{children:"Click izquierdo: revelar | Click derecho: bandera"})})]})};export{T as default};
