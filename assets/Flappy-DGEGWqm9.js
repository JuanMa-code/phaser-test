import{r as u,j as o}from"./index-DT6De0vj.js";import{P as l}from"./phaser-CtSIbetW.js";import{G as v,a as x}from"./GameOverScreen-DSWsITTW.js";const a=480,h=640,s=24,y=80,g=140;class S extends l.Scene{bird;pipes;clouds;ground;scoreText;score=0;isGameOver=!1;pipeTimer=null;onGameOver;onScoreUpdate;constructor(e,t){super("FlappyScene"),this.onGameOver=e,this.onScoreUpdate=t}preload(){this.createTextures()}createTextures(){const e=this.make.graphics({x:0,y:0});e.fillStyle(16766720),e.fillEllipse(s,s,s,s*.8),e.fillStyle(16753920),e.fillEllipse(s-8,s-5,15,8),e.fillStyle(16737095),e.fillTriangle(s+10,s-5,s+25,s,s+10,s+5),e.fillStyle(0),e.fillCircle(s+8,s-5,4),e.fillStyle(16777215),e.fillCircle(s+10,s-6,2),e.generateTexture("bird",s*2+10,s*2);const t=this.make.graphics({x:0,y:0});t.fillStyle(5025616),t.fillRoundedRect(0,0,y,600,8),t.fillStyle(6732650),t.fillRect(8,0,8,600),t.fillRect(y-16,0,8,600),t.fillStyle(3706428),t.fillRoundedRect(-4,0,y+8,24,4),t.generateTexture("pipe",y+8,600);const r=this.make.graphics({x:0,y:0});r.fillStyle(16777215,.8),r.fillCircle(20,20,18),r.fillCircle(45,20,22),r.fillCircle(70,20,18),r.fillCircle(32,10,14),r.fillCircle(57,10,16),r.generateTexture("cloud",100,50);const i=this.make.graphics({x:0,y:0});i.fillStyle(9159498),i.fillRect(0,0,a,80),i.fillStyle(5025616);for(let n=0;n<a;n+=20)i.fillRect(n,0,10,20);i.generateTexture("ground",a,80)}create(){this.physics.world.setBounds(0,0,a,h),this.add.rectangle(0,0,a,h,7390670).setOrigin(0),this.clouds=this.add.group(),this.time.addEvent({delay:2e3,callback:this.spawnCloud,callbackScope:this,loop:!0});for(let e=0;e<3;e++)this.spawnCloud(!0);this.pipes=this.physics.add.group(),this.ground=this.add.tileSprite(a/2,h-40,a,80,"ground"),this.physics.add.existing(this.ground,!0),this.ground.body.setImmovable(!0),this.ground.setDepth(10),this.bird=this.physics.add.sprite(120,h/2,"bird"),this.bird.setCollideWorldBounds(!0),this.bird.setGravityY(1e3),this.bird.setDepth(5),this.bird.body.setSize(s*1.5,s*1.5),this.input.on("pointerdown",this.flap,this),this.input.keyboard.on("keydown-SPACE",this.flap,this),this.input.keyboard.on("keydown-UP",this.flap,this),this.input.keyboard.on("keydown-W",this.flap,this),this.scoreText=this.add.text(a/2,80,"0",{fontSize:"48px",color:"#ffffff",stroke:"#000000",strokeThickness:4}).setOrigin(.5).setDepth(20),this.physics.add.collider(this.bird,this.ground,this.gameOver,void 0,this),this.physics.add.overlap(this.bird,this.pipes,this.gameOver,void 0,this),this.pipeTimer=this.time.addEvent({delay:1500,callback:this.spawnPipe,callbackScope:this,loop:!0})}spawnCloud(e=!1){const t=e?l.Math.Between(0,a):a+50,r=l.Math.Between(50,300),i=this.add.image(t,r,"cloud");this.clouds.add(i),this.tweens.add({targets:i,x:-100,duration:l.Math.Between(1e4,15e3),onComplete:()=>i.destroy()})}spawnPipe(){if(this.isGameOver)return;const e=l.Math.Between(150,h-250),t=this.pipes.create(a+50,e-g/2,"pipe");t.setOrigin(.5,1),t.setFlipY(!0),t.body.allowGravity=!1,t.setVelocityX(-200),t.setImmovable(!0);const r=this.pipes.create(a+50,e+g/2,"pipe");r.setOrigin(.5,0),r.body.allowGravity=!1,r.setVelocityX(-200),r.setImmovable(!0);const i=this.add.zone(a+50,e,1,g);this.physics.add.existing(i),i.body.setAllowGravity(!1),i.body.setVelocityX(-200),this.physics.add.overlap(this.bird,i,(n,d)=>{d.destroy(),this.incrementScore()},void 0,this)}flap(){this.isGameOver||(this.bird.setVelocityY(-350),this.tweens.add({targets:this.bird,angle:-25,duration:100,ease:"Power1"}))}incrementScore(){this.score++,this.scoreText.setText(this.score.toString()),this.onScoreUpdate(this.score),this.score%5===0&&this.pipes.getChildren().forEach(e=>{e.body&&(e.body.velocity.x-=20)})}gameOver(){this.isGameOver||(this.isGameOver=!0,this.physics.pause(),this.bird.setTint(16711680),this.pipeTimer&&this.pipeTimer.remove(),this.onGameOver(this.score))}update(){this.isGameOver||(this.bird.body.velocity.y>0&&this.bird.angle<90&&(this.bird.angle+=2.5),this.ground.tilePositionX+=2,this.pipes.children.entries.forEach(e=>{e.x<-50&&e.destroy()}))}}const w=()=>{const[p,e]=u.useState("start"),[t,r]=u.useState(0),[i,n]=u.useState(()=>{const f=localStorage.getItem("flappy-highscore");return f?parseInt(f):0}),d=u.useRef(null);u.useEffect(()=>{if(p==="playing"){const f={type:l.AUTO,width:a,height:h,parent:"phaser-game",backgroundColor:"#70C5CE",physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}},scene:new S(c=>{r(c),c>i&&(n(c),localStorage.setItem("flappy-highscore",c.toString())),e("gameOver")},c=>{r(c)})};return d.current=new l.Game(f),()=>{d.current&&(d.current.destroy(!0),d.current=null)}}},[p,i]);const m=()=>{e("playing"),r(0)},b=()=>{e("playing"),r(0)};return p==="start"?o.jsx(v,{title:"üê¶ FLAPPY BIRD",description:"¬°Ayuda al p√°jaro a volar entre las tuber√≠as!",highScore:i,instructions:[{title:"Controles",items:["üöÄ Espacio/‚Üë/W: Aletear hacia arriba","üñ±Ô∏è Click: Tambi√©n hace aletear"],icon:"üéÆ"},{title:"Objetivo",items:["üìä 1 punto por tuber√≠a pasada","‚ö° La velocidad aumenta cada 5 puntos"],icon:"üéØ"},{title:"Consejos",items:["El timing es la clave del √©xito","No aletees demasiado seguido","Mant√©n una altitud constante"],icon:"üí°"}],onStart:m,theme:{primary:"#FFD700",secondary:"#FFA500",accent:"#70C5CE",background:"linear-gradient(135deg, #70C5CE 0%, #8BC34A 100%)"}}):p==="gameOver"?o.jsx(x,{score:t,highScore:i,onRestart:b,onMenu:()=>e("start"),theme:{primary:"#FFD700",secondary:"#FFA500",accent:"#70C5CE",background:"linear-gradient(135deg, #70C5CE 0%, #8BC34A 100%)"},customStats:[{label:"Puntuaci√≥n",value:t},{label:"R√©cord",value:i}]}):o.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",background:"linear-gradient(135deg, #70C5CE 0%, #8BC34A 100%)",minHeight:"100dvh",fontFamily:"Arial, sans-serif",color:"#2E7D32"},children:[o.jsx("h1",{style:{margin:"0 0 20px 0",fontSize:"2.5rem"},children:"üê¶ FLAPPY BIRD"}),o.jsx("div",{id:"phaser-game",style:{border:"3px solid #FFD700",borderRadius:"10px",overflow:"hidden"}}),o.jsx("div",{style:{marginTop:"20px",fontSize:"1.2rem"},children:o.jsx("p",{children:"Espacio/‚Üë/W/Click para aletear"})})]})};export{w as default};
