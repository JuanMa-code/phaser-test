import{r as L,j as F}from"./index-fqapEabv.js";import{A as S,G as u,T as x}from"./HTMLText-B2fYd3Bg.js";const d=10,c=10,i=40,j=15,H=()=>{const h=L.useRef(null);return L.useEffect(()=>{const l=new S({width:d*i,height:c*i,backgroundColor:15658734});h.current&&l.view instanceof Node&&h.current.appendChild(l.view);let s=[],f=!1,g=!1;function b(){s=Array.from({length:c},()=>Array.from({length:d},()=>({mine:!1,revealed:!1,flagged:!1,adjacent:0})));let t=0;for(;t<j;){const e=Math.floor(Math.random()*d),o=Math.floor(Math.random()*c);s[o][e].mine||(s[o][e].mine=!0,t++)}for(let e=0;e<c;e++)for(let o=0;o<d;o++){let n=0;for(let a=-1;a<=1;a++)for(let r=-1;r<=1;r++){if(r===0&&a===0)continue;const m=o+r,v=e+a;m>=0&&m<d&&v>=0&&v<c&&s[v][m].mine&&n++}s[e][o].adjacent=n}}function p(t,e){if(!(s[e][t].revealed||s[e][t].flagged)){if(s[e][t].revealed=!0,s[e][t].mine){f=!0,w();return}if(s[e][t].adjacent===0)for(let o=-1;o<=1;o++)for(let n=-1;n<=1;n++){const a=t+n,r=e+o;a>=0&&a<d&&r>=0&&r<c&&(s[r][a].revealed||p(a,r))}}}function R(){for(let t=0;t<c;t++)for(let e=0;e<d;e++)if(!s[t][e].mine&&!s[t][e].revealed)return!1;return g=!0,!0}function w(){l.stage.removeChildren();for(let t=0;t<c;t++)for(let e=0;e<d;e++){const o=new u;if(o.lineStyle(2,8947848),o.beginFill(s[t][e].revealed?16777215:13421772),o.drawRect(0,0,i,i),o.endFill(),o.x=e*i,o.y=t*i,l.stage.addChild(o),s[t][e].revealed){if(s[t][e].mine){const n=new u;n.beginFill(16711680),n.drawCircle(i/2,i/2,i/4),n.endFill(),n.x=e*i,n.y=t*i,l.stage.addChild(n)}else if(s[t][e].adjacent>0){const n=new x(`${s[t][e].adjacent}`,{fill:2236962,fontSize:24});n.x=e*i+i/2-8,n.y=t*i+i/2-16,l.stage.addChild(n)}}else if(s[t][e].flagged){const n=new u;n.beginFill(255),n.drawRect(i/2-8,i/2-16,16,24),n.endFill(),n.x=e*i,n.y=t*i,l.stage.addChild(n)}}if(f){const t="Game Over! Pulsa espacio para reiniciar",e=new x(t,{fill:"#ff0000",fontSize:24}),o=e.width,n=e.height,a=16,r=new u;r.beginFill(16777215,.85),r.drawRect((d*i-o)/2-a,(c*i-n)/2-a,o+a*2,n+a*2),r.endFill(),l.stage.addChild(r),e.x=(d*i-o)/2,e.y=(c*i-n)/2,l.stage.addChild(e)}if(g){const t="Â¡Has ganado! Pulsa espacio para reiniciar",e=new x(t,{fill:43520,fontSize:24}),o=e.width,n=e.height,a=16,r=new u;r.beginFill(16777215,.85),r.drawRect((d*i-o)/2-a,(c*i-n)/2-a,o+a*2,n+a*2),r.endFill(),l.stage.addChild(r),e.x=(d*i-o)/2,e.y=(c*i-n)/2,l.stage.addChild(e)}}function C(t){if(f||g||!(l.view instanceof HTMLCanvasElement))return;const e=l.view.getBoundingClientRect(),o=t.clientX-e.left,n=t.clientY-e.top,a=Math.floor(o/i),r=Math.floor(n/i);a>=0&&a<d&&r>=0&&r<c&&(p(a,r),R(),w())}function y(t){if(t.preventDefault(),f||g||!(l.view instanceof HTMLCanvasElement))return;const e=l.view.getBoundingClientRect(),o=t.clientX-e.left,n=t.clientY-e.top,a=Math.floor(o/i),r=Math.floor(n/i);a>=0&&a<d&&r>=0&&r<c&&(s[r][a].flagged=!s[r][a].flagged,w())}function E(){f=!1,g=!1,b(),w()}l.view instanceof HTMLCanvasElement&&(l.view.addEventListener("mousedown",C),l.view.addEventListener("contextmenu",y));const M=t=>{(f||g)&&t.code==="Space"&&E()};return window.addEventListener("keydown",M),E(),()=>{window.removeEventListener("keydown",M),l.view instanceof HTMLCanvasElement&&(l.view.removeEventListener("mousedown",C),l.view.removeEventListener("contextmenu",y)),l.destroy(!0,{children:!0})}},[]),F.jsx("div",{ref:h,style:{width:d*i,height:c*i+48,margin:"auto"}})};export{H as default};
