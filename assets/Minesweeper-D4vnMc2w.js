import{r as L,A as F,j as S,G as u,T as x}from"./index-CNjAg9KX.js";const d=10,c=10,i=40,j=15,k=()=>{const h=L.useRef(null);return L.useEffect(()=>{const r=new F({width:d*i,height:c*i,backgroundColor:15658734});h.current&&r.view instanceof Node&&h.current.appendChild(r.view);let s=[],f=!1,g=!1;function b(){s=Array.from({length:c},()=>Array.from({length:d},()=>({mine:!1,revealed:!1,flagged:!1,adjacent:0})));let t=0;for(;t<j;){const e=Math.floor(Math.random()*d),o=Math.floor(Math.random()*c);s[o][e].mine||(s[o][e].mine=!0,t++)}for(let e=0;e<c;e++)for(let o=0;o<d;o++){let n=0;for(let a=-1;a<=1;a++)for(let l=-1;l<=1;l++){if(l===0&&a===0)continue;const v=o+l,m=e+a;v>=0&&v<d&&m>=0&&m<c&&s[m][v].mine&&n++}s[e][o].adjacent=n}}function C(t,e){if(!(s[e][t].revealed||s[e][t].flagged)){if(s[e][t].revealed=!0,s[e][t].mine){f=!0,w();return}if(s[e][t].adjacent===0)for(let o=-1;o<=1;o++)for(let n=-1;n<=1;n++){const a=t+n,l=e+o;a>=0&&a<d&&l>=0&&l<c&&(s[l][a].revealed||C(a,l))}}}function R(){for(let t=0;t<c;t++)for(let e=0;e<d;e++)if(!s[t][e].mine&&!s[t][e].revealed)return!1;return g=!0,!0}function w(){r.stage.removeChildren();for(let t=0;t<c;t++)for(let e=0;e<d;e++){const o=new u;if(o.lineStyle(2,8947848),o.beginFill(s[t][e].revealed?16777215:13421772),o.drawRect(0,0,i,i),o.endFill(),o.x=e*i,o.y=t*i,r.stage.addChild(o),s[t][e].revealed){if(s[t][e].mine){const n=new u;n.beginFill(16711680),n.drawCircle(i/2,i/2,i/4),n.endFill(),n.x=e*i,n.y=t*i,r.stage.addChild(n)}else if(s[t][e].adjacent>0){const n=new x(`${s[t][e].adjacent}`,{fill:2236962,fontSize:24});n.x=e*i+i/2-8,n.y=t*i+i/2-16,r.stage.addChild(n)}}else if(s[t][e].flagged){const n=new u;n.beginFill(255),n.drawRect(i/2-8,i/2-16,16,24),n.endFill(),n.x=e*i,n.y=t*i,r.stage.addChild(n)}}if(f){const t="Game Over! Pulsa espacio para reiniciar",e=new x(t,{fill:"#ff0000",fontSize:24}),o=e.width,n=e.height,a=16,l=new u;l.beginFill(16777215,.85),l.drawRect((d*i-o)/2-a,(c*i-n)/2-a,o+a*2,n+a*2),l.endFill(),r.stage.addChild(l),e.x=(d*i-o)/2,e.y=(c*i-n)/2,r.stage.addChild(e)}if(g){const t="Â¡Has ganado! Pulsa espacio para reiniciar",e=new x(t,{fill:43520,fontSize:24}),o=e.width,n=e.height,a=16,l=new u;l.beginFill(16777215,.85),l.drawRect((d*i-o)/2-a,(c*i-n)/2-a,o+a*2,n+a*2),l.endFill(),r.stage.addChild(l),e.x=(d*i-o)/2,e.y=(c*i-n)/2,r.stage.addChild(e)}}function p(t){if(f||g||!(r.view instanceof HTMLCanvasElement))return;const e=r.view.getBoundingClientRect(),o=t.clientX-e.left,n=t.clientY-e.top,a=Math.floor(o/i),l=Math.floor(n/i);a>=0&&a<d&&l>=0&&l<c&&(C(a,l),R(),w())}function y(t){if(t.preventDefault(),f||g||!(r.view instanceof HTMLCanvasElement))return;const e=r.view.getBoundingClientRect(),o=t.clientX-e.left,n=t.clientY-e.top,a=Math.floor(o/i),l=Math.floor(n/i);a>=0&&a<d&&l>=0&&l<c&&(s[l][a].flagged=!s[l][a].flagged,w())}function E(){f=!1,g=!1,b(),w()}r.view instanceof HTMLCanvasElement&&(r.view.addEventListener("mousedown",p),r.view.addEventListener("contextmenu",y));const M=t=>{(f||g)&&t.code==="Space"&&E()};return window.addEventListener("keydown",M),E(),()=>{window.removeEventListener("keydown",M),r.view instanceof HTMLCanvasElement&&(r.view.removeEventListener("mousedown",p),r.view.removeEventListener("contextmenu",y)),r.destroy(!0,{children:!0})}},[]),S.jsx("div",{ref:h,style:{width:d*i,height:c*i+48,margin:"auto"}})};export{k as default};
