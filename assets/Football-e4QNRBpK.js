import{r as y,j as o}from"./index-DT6De0vj.js";import{P as m}from"./phaser-CtSIbetW.js";import{G as D,a as w}from"./GameOverScreen-DSWsITTW.js";const r=1e3,i=600,u=15,x=6,b=80,S=180;class v extends m.Scene{players=[];ball;cursors;wasd;selectedPlayerIndex;gameState;onScoreUpdate;onTimeUpdate;onGameOver;timerEvent;countdownText;constructor(e,s,t,a){super("FootballScene"),this.selectedPlayerIndex=e,this.onScoreUpdate=s,this.onTimeUpdate=t,this.onGameOver=a,this.gameState={currentHalf:1,timeLeft:S,blueScore:0,redScore:0,isCountdown:!1,gameStarted:!1}}preload(){this.createTextures()}createTextures(){const e=this.make.graphics({x:0,y:0});e.fillStyle(2263842),e.fillRect(0,0,r,i),e.lineStyle(3,16777215),e.strokeRect(10,10,r-20,i-20),e.beginPath(),e.moveTo(r/2,10),e.lineTo(r/2,i-10),e.strokePath(),e.strokeCircle(r/2,i/2,60),e.strokeRect(10,i/2-100,120,200),e.strokeRect(10,i/2-50,50,100),e.strokeRect(r-130,i/2-100,120,200),e.strokeRect(r-60,i/2-50,50,100),e.generateTexture("field",r,i);const s=(a,l)=>{const n=this.make.graphics({x:0,y:0});n.fillStyle(a),n.fillCircle(u,u,u),n.lineStyle(2,0),n.strokeCircle(u,u,u),n.generateTexture(l,u*2,u*2)};s(26367,"player-blue"),s(16711680,"player-red");const t=this.make.graphics({x:0,y:0});t.fillStyle(16777215),t.fillCircle(x,x,x),t.lineStyle(1,0),t.strokeCircle(x,x,x),t.generateTexture("ball",x*2,x*2)}create(){this.add.image(r/2,i/2,"field"),this.physics.world.setBounds(0,0,r,i),this.ball=this.physics.add.sprite(r/2,i/2,"ball"),this.ball.setCollideWorldBounds(!0),this.ball.setBounce(.7),this.ball.setDrag(.98),this.ball.setCircle(x),this.initializePlayers(),this.input.keyboard&&(this.cursors=this.input.keyboard.createCursorKeys(),this.wasd={up:this.input.keyboard.addKey(m.Input.Keyboard.KeyCodes.W),down:this.input.keyboard.addKey(m.Input.Keyboard.KeyCodes.S),left:this.input.keyboard.addKey(m.Input.Keyboard.KeyCodes.A),right:this.input.keyboard.addKey(m.Input.Keyboard.KeyCodes.D)}),this.players.forEach(e=>{this.physics.add.collider(e,this.ball,this.handlePlayerBallCollision,void 0,this),this.players.forEach(s=>{e!==s&&this.physics.add.collider(e,s)})}),this.countdownText=this.add.text(r/2,i/2,"",{fontSize:"80px",color:"#ffffff",stroke:"#000000",strokeThickness:6}).setOrigin(.5).setDepth(100),this.startCountdown(()=>{this.gameState.gameStarted=!0,this.startTimer()})}initializePlayers(){this.players.forEach(t=>t.destroy()),this.players=[];const e=[{x:80,y:i/2,pos:"GK"},{x:180,y:i*.3,pos:"DEF"},{x:180,y:i*.7,pos:"DEF"},{x:280,y:i*.25,pos:"MID"},{x:280,y:i*.75,pos:"MID"},{x:380,y:i/2,pos:"ATT"}],s=[{x:r-80,y:i/2,pos:"GK"},{x:r-180,y:i*.3,pos:"DEF"},{x:r-180,y:i*.7,pos:"DEF"},{x:r-280,y:i*.25,pos:"MID"},{x:r-280,y:i*.75,pos:"MID"},{x:r-380,y:i/2,pos:"ATT"}];e.forEach((t,a)=>{this.createPlayer(a,t.x,t.y,"blue",t.pos)}),s.forEach((t,a)=>{this.createPlayer(a+6,t.x,t.y,"red",t.pos)})}createPlayer(e,s,t,a,l){const n=a==="blue"?"player-blue":"player-red",d=this.physics.add.sprite(s,t,n);d.setCollideWorldBounds(!0),d.setCircle(u),d.setDrag(500);const g=a==="blue"&&e===this.selectedPlayerIndex;if(g){const c=this.add.graphics();c.lineStyle(3,16776960),c.strokeCircle(0,0,u+2),d.setData("ring",c)}const T=this.calculateActionZone(l,a);d.setData("playerData",{id:e,team:a,position:l,originalX:s,originalY:t,speed:l==="GK"?150:l==="DEF"?180:l==="MID"?210:190,actionZone:T,isControlled:g});const h=this.add.text(0,0,(e%6+1).toString(),{fontSize:"12px",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5);d.setData("text",h),this.players.push(d)}calculateActionZone(e,s){const t=s==="blue",a=r/3;switch(e){case"GK":return t?{minX:10,maxX:a*.5,minY:50,maxY:i-50}:{minX:a*2.5,maxX:r-10,minY:50,maxY:i-50};case"DEF":return t?{minX:10,maxX:a*1.5,minY:20,maxY:i-20}:{minX:a*1.5,maxX:r-10,minY:20,maxY:i-20};case"MID":return t?{minX:a*.6,maxX:a*2.9,minY:20,maxY:i-20}:{minX:a*.1,maxX:a*2.4,minY:20,maxY:i-20};case"ATT":return t?{minX:a*1.5,maxX:r-10,minY:20,maxY:i-20}:{minX:10,maxX:a*1.5,minY:20,maxY:i-20};default:return{minX:0,maxX:r,minY:0,maxY:i}}}handlePlayerBallCollision(e,s){const t=e,a=s,n=t.getData("playerData").isControlled?400:300,d=m.Math.Angle.Between(t.x,t.y,a.x,a.y);a.setVelocity(Math.cos(d)*n,Math.sin(d)*n)}startCountdown(e){this.gameState.isCountdown=!0;let s=3;this.countdownText.setText(s.toString()),this.countdownText.setVisible(!0),this.time.addEvent({delay:1e3,repeat:3,callback:()=>{s--,s>0?this.countdownText.setText(s.toString()):s===0?this.countdownText.setText("GO!"):(this.countdownText.setVisible(!1),this.gameState.isCountdown=!1,e())}})}startTimer(){this.timerEvent=this.time.addEvent({delay:1e3,loop:!0,callback:()=>{this.gameState.isCountdown||(this.gameState.timeLeft--,this.onTimeUpdate(this.gameState.timeLeft,this.gameState.currentHalf),this.gameState.timeLeft<=0&&this.handleHalfTime())}})}handleHalfTime(){this.timerEvent.remove(),this.gameState.currentHalf===1?(this.gameState.currentHalf=2,this.gameState.timeLeft=S,this.gameState.gameStarted=!1,this.resetPositions(),this.startCountdown(()=>{this.gameState.gameStarted=!0,this.startTimer()})):(this.gameState.gameStarted=!1,this.onGameOver(this.gameState.blueScore,this.gameState.redScore))}resetPositions(){this.ball.setPosition(r/2,i/2),this.ball.setVelocity(0,0),this.players.forEach(e=>{const s=e.getData("playerData");e.setPosition(s.originalX,s.originalY),e.setVelocity(0,0)})}update(){!this.gameState.gameStarted||this.gameState.isCountdown||(this.players.forEach(e=>{e.getData("text").setPosition(e.x,e.y);const t=e.getData("ring");t&&t.setPosition(e.x,e.y)}),this.ball.setVelocity(this.ball.body.velocity.x*.98,this.ball.body.velocity.y*.98),this.ball.x<20&&this.ball.y>i/2-b/2&&this.ball.y<i/2+b/2?this.handleGoal("red"):this.ball.x>r-20&&this.ball.y>i/2-b/2&&this.ball.y<i/2+b/2&&this.handleGoal("blue"),this.players.forEach(e=>{const s=e.getData("playerData");s.isControlled?this.handlePlayerControl(e,s):this.handleAI(e,s)}))}handlePlayerControl(e,s){const t=s.speed;let a=0,l=0;this.cursors.left.isDown||this.wasd.left.isDown?a=-t:(this.cursors.right.isDown||this.wasd.right.isDown)&&(a=t),this.cursors.up.isDown||this.wasd.up.isDown?l=-t:(this.cursors.down.isDown||this.wasd.down.isDown)&&(l=t),e.setVelocity(a,l)}handleAI(e,s){const t=this.ball;m.Math.Distance.Between(e.x,e.y,t.x,t.y);const a=s.actionZone;let l=s.originalX,n=s.originalY;t.x>=a.minX&&t.x<=a.maxX&&t.y>=a.minY&&t.y<=a.maxY&&(l=t.x,n=t.y),this.physics.moveTo(e,l,n,s.speed),m.Math.Distance.Between(e.x,e.y,l,n)<5&&l!==t.x&&e.setVelocity(0,0)}handleGoal(e){e==="blue"?this.gameState.blueScore++:this.gameState.redScore++,this.onScoreUpdate(this.gameState.blueScore,this.gameState.redScore),this.countdownText.setText("GOAL!"),this.countdownText.setVisible(!0),this.gameState.isCountdown=!0,this.time.delayedCall(2e3,()=>{this.resetPositions(),this.startCountdown(()=>{this.gameState.isCountdown=!1})})}}const P=()=>{const[f,e]=y.useState("start"),[s,t]=y.useState(0),[a,l]=y.useState({blue:0,red:0}),[n,d]=y.useState({time:S,half:1}),g=y.useRef(null);y.useEffect(()=>{if(f==="playing"){const h={type:m.AUTO,width:r,height:i,parent:"phaser-game",backgroundColor:"#228B22",physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}},scene:new v(s,(c,p)=>l({blue:c,red:p}),(c,p)=>d({time:c,half:p}),(c,p)=>{l({blue:c,red:p}),e("gameOver")})};return g.current=new m.Game(h),()=>{g.current&&(g.current.destroy(!0),g.current=null)}}},[f,s]);const T=h=>{const c=Math.floor(h/60),p=h%60;return`${c}:${p.toString().padStart(2,"0")}`};if(f==="start")return o.jsx(D,{title:"âš½ FÃšTBOL",description:"Â¡Controla a tu jugador y ayuda a tu equipo a marcar goles!",instructions:[{title:"Controles",items:["WASD / Flechas: Mover jugador"],icon:"ðŸŽ®"},{title:"Reglas",items:["AcÃ©rcate a la pelota para patearla","Tu jugador tiene borde amarillo","El equipo azul ataca hacia la derecha"],icon:"ðŸ“‹"}],onStart:()=>e("playing"),theme:{primary:"#4caf50",secondary:"#2e7d32",accent:"#66bb6a",background:"linear-gradient(135deg, #2e7d32 0%, #4caf50 50%, #66bb6a 100%)"},children:o.jsxs("div",{style:{marginBottom:"30px",padding:"20px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"10px",border:"1px solid rgba(255, 255, 255, 0.2)"},children:[o.jsx("h3",{style:{color:"white",marginBottom:"15px"},children:"ðŸ‘¤ SELECCIONA TU JUGADOR:"}),o.jsxs("select",{value:s,onChange:h=>t(Number(h.target.value)),style:{padding:"8px 15px",fontSize:"16px",borderRadius:"5px",border:"2px solid #ddd",width:"100%",background:"rgba(255, 255, 255, 0.9)"},children:[o.jsx("option",{value:0,children:"Portero (GK)"}),o.jsx("option",{value:1,children:"Defensa 1 (DEF)"}),o.jsx("option",{value:2,children:"Defensa 2 (DEF)"}),o.jsx("option",{value:3,children:"Medio 1 (MID)"}),o.jsx("option",{value:4,children:"Medio 2 (MID)"}),o.jsx("option",{value:5,children:"Delantero (ATT)"})]})]})});if(f==="gameOver"){const h=a.blue>a.red?"GANÃ“ EQUIPO AZUL":a.red>a.blue?"GANÃ“ EQUIPO ROJO":"EMPATE";return o.jsx(w,{score:a.blue,onRestart:()=>{l({blue:0,red:0}),d({time:S,half:1}),e("playing")},onMenu:()=>e("start"),theme:{primary:"#4caf50",secondary:"#2e7d32",accent:"#66bb6a",background:"linear-gradient(135deg, #2e7d32 0%, #4caf50 100%)"},customStats:[{label:"Equipo Azul",value:a.blue},{label:"Equipo Rojo",value:a.red},{label:"Resultado",value:h}]})}return o.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",minHeight:"100dvh",background:"linear-gradient(135deg, #2e7d32 0%, #4caf50 100%)",padding:"20px"},children:[o.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.9)",padding:"15px 30px",borderRadius:"15px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"30px",fontSize:"1.1rem",fontWeight:"bold",boxShadow:"0 5px 15px rgba(0,0,0,0.2)"},children:[o.jsxs("div",{style:{color:"#0066FF"},children:["AZUL: ",a.blue]}),o.jsxs("div",{style:{color:"#333",textAlign:"center"},children:[o.jsx("div",{style:{fontSize:"1.2rem"},children:"FÃšTBOL âš½"}),o.jsxs("div",{style:{fontSize:"0.9rem",marginTop:"5px"},children:[n.half,"Â° TIEMPO - ",T(n.time)]})]}),o.jsxs("div",{style:{color:"#FF0000"},children:["ROJO: ",a.red]})]}),o.jsx("div",{id:"phaser-game",style:{border:"4px solid #fff",borderRadius:"10px",boxShadow:"0 10px 30px rgba(0,0,0,0.3)",overflow:"hidden"}}),o.jsxs("div",{style:{marginTop:"20px",background:"rgba(255, 255, 255, 0.9)",padding:"15px",borderRadius:"10px",textAlign:"center",maxWidth:"600px"},children:[o.jsxs("p",{style:{margin:"5px 0",color:"#333"},children:[o.jsx("strong",{children:"Controles:"})," WASD o Flechas para mover"]}),o.jsx("p",{style:{margin:"5px 0",color:"#666",fontSize:"0.9rem"},children:"Tu jugador tiene un borde amarillo. AcÃ©rcate a la pelota para patearla."})]})]})};export{P as default};
